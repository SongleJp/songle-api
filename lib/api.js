!function(e,t){if("object"===typeof exports&&"object"===typeof module)module.exports=t();else if("function"===typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"===typeof exports?exports:e)[r]=n[r]}}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/packs/",n(n.s=411)}({1:function(e,t,n){"use strict";n.r(t),function(e){var r=n(8),i={};!function(e){Object.defineProperties(i,{currentClockTime:{configurable:!0,get:function(){return Date.now()}},defaultAppServerProtocol:{configurable:!0,get:function(){return i.__defaultAppServerProtocol__||"https:"},set:function(e){i.__defaultAppServerProtocol__=e}},defaultAppServerHost:{configurable:!0,get:function(){return i.__defaultAppServerHost__||"api.songle.jp"},set:function(e){i.__defaultAppServerHost__=e}},defaultAppServerEndpoint:{configurable:!0,get:function(){return i.defaultAppServerProtocol+"//"+i.defaultAppServerHost}},defaultLogServerProtocol:{configurable:!0,get:function(){return i.__defaultLogServerProtocol__||"https:"},set:function(e){i.__defaultLogServerProtocol__=e}},defaultLogServerHost:{configurable:!0,get:function(){return i.__defaultLogServerHost__||"log.songle.jp"},set:function(e){i.__defaultLogServerHost__=e}},defaultLogServerEndpoint:{configurable:!0,get:function(){return i.defaultLogServerProtocol+"//"+i.defaultLogServerHost}},defaultWebsocketServerProtocol:{configurable:!0,get:function(){return i.__defaultWebsocketServerProtocol__||"wss:"},set:function(e){i.__defaultWebsocketServerProtocol__=e}},defaultWebsocketServerHost:{configurable:!0,get:function(){return i.__defaultWebsocketServerHost__||"api.songle.jp"},set:function(e){i.__defaultWebsocketServerHost__=e}},defaultWebsocketServerEndpoint:{configurable:!0,get:function(){return i.defaultWebsocketServerProtocol+"//"+i.defaultWebsocketServerHost}},global:{configurable:!0,get:function(){return e}},isStandalone:{configurable:!0,get:function(){return!e.document}},isWebBrowser:{configurable:!0,get:function(){return!!e.document}},language:{configurable:!0,get:function(){var e=window.navigator.languages&&window.navigator.languages[0]||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage;switch(!0){case/en/.test(e.toLowerCase()):return"en";case/ja/.test(e.toLowerCase()):return"ja";default:return"en"}}},referer:{configurable:!0,get:function(){return i.isStandalone?"-":e.document.referrer}},userAgent:{configurable:!0,get:function(){return i.isStandalone?"-":e.navigator.appCodeName+"/"+navigator.appVersion}},userAgentIsLaptop:{configurable:!0,get:function(){return!i.userAgentIsAndroid&&!i.userAgentIsiOS}},userAgentIsMobile:{configurable:!0,get:function(){return i.userAgentIsAndroid||i.userAgentIsiOS}},userAgentIsAndroid:{configurable:!0,get:function(){return-1!=i.userAgent.toLowerCase().indexOf("android")||-1!=i.userAgent.toLowerCase().indexOf("linux")}},userAgentIsiOS:{configurable:!0,get:function(){return-1!=i.userAgent.toLowerCase().indexOf("iphone")||-1!=i.userAgent.toLowerCase().indexOf("ipad")||-1!=i.userAgent.toLowerCase().indexOf("ipod")}},searchQueries:{configurable:!0,get:function(){var e={};return location.search.slice(location.search.indexOf("?")+1).split("&").forEach(function(t){var n=t.match(/(.+?)=(.+)/);if(n){var r=n[1],i=n[2];e[r]=i?decodeURIComponent(i):i}}),e}},showDebugLog:{configurable:!0,get:function(){return!!i.__showDebugLog__},set:function(e){i.__showDebugLog__=!!e}},showErrorLog:{configurable:!0,get:function(){return!!i.__showErrorLog__},set:function(e){i.__showErrorLog__=!!e}},showLicense:{configurable:!0,get:function(){return!!i.__showLicense__},set:function(e){i.__showLicense__=!!e,e?(r.default.removeLicense(),r.default.createLicense(e)):(r.default.removeLicense(),console.log("# \u30e9\u30a4\u30bb\u30f3\u30b9\u8868\u8a18\u306b\u95a2\u3059\u308b\u30ac\u30a4\u30c9\u30e9\u30a4\u30f3\n\n\u56fd\u7acb\u7814\u7a76\u958b\u767a\u6cd5\u4eba\u7523\u696d\u6280\u8853\u7dcf\u5408\u7814\u7a76\u6240\n\u60c5\u5831\u6280\u8853\u7814\u7a76\u90e8\u9580\n\u30e1\u30c7\u30a3\u30a2\u30a4\u30f3\u30bf\u30e9\u30af\u30b7\u30e7\u30f3\u7814\u7a76\u30b0\u30eb\u30fc\u30d7\n\nSongle API\u306f\u975e\u5546\u7528\u5229\u7528\u306b\u9650\u308a\u3001\u3069\u306a\u305f\u3067\u3082\u7121\u6599\u30fb\u7121\u4fdd\u8a3c\u3067\u5229\u7528\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u305f\u3060\u3057\u3001\u539f\u5247\u3068\u3057\u3066Songle API\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u65e8\u3092 https://api.songle.jp/ \u306b\u30cf\u30a4\u30d1\u30fc\u30ea\u30f3\u30af\u3057\u305f\u4e0a\u3067\u3001\u5229\u7528\u3057\u3066\u3044\u308b\u30b7\u30b9\u30c6\u30e0\u3082\u3057\u304f\u306f\u5916\u90e8\u30b5\u30a4\u30c8\u7b49\u306b\u8868\u793a\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002\n\n# \u304a\u554f\u3044\u5408\u308f\u305b\n\nsongle-ml@aist.go.jp"))}}}),i.stringIsBlank=function(e){return""==e||null==e},i.typeOf=function(e){if(null!=e)switch(typeof e){case"object":return null!=e.length?"array":"object";case"number":return"number";case"string":return"string"}return"null"},e.__sw__=i}((0).self||e),t.default=i}.call(this,n(17))},104:function(e,t,n){var r=n(134),i=n(135);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var u=0;u<16;++u)t[a+u]=o[u];return t||i(o)}},12:function(e,t,n){"use strict";n.r(t);var r=n(20);n.d(t,"SongAPI",function(){return r.default});var i=n(21);n.d(t,"BeatAPI",function(){return i.default});var a=n(22);n.d(t,"ChordAPI",function(){return a.default});var o=n(23);n.d(t,"MelodyAPI",function(){return o.default});var u=n(24);n.d(t,"ChorusAPI",function(){return u.default});var s=n(25);n.d(t,"VariationAPI",function(){return s.default});var c={SongAPI:r.default,BeatAPI:i.default,ChordAPI:a.default,MelodyAPI:o.default,ChorusAPI:u.default,VariationAPI:s.default};t.default=c},13:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.__player__=t}var t,n,i;return t=e,(n=[{key:"dispatch",value:function(e,t,n){}},{key:"find",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null!=t.offset?t.offset:0,r=this.__player__.positionTime-250+-1*n,i=this.__player__.positionTime+0+-1*n;this.dispatch(r,i,e)}},{key:"reset",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}])&&r(t.prototype,n),i&&r(t,i),e}();t.default=i},134:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},135:function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},14:function(e,t,n){"use strict";n.r(t);var r=500;function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[];return e.musicMap.chorus&&e.musicMap.chorus.forEach(function(e){t.chorusOnly&&!e.isChorus||(n=n.concat(e.items).sort(function(e,t){return e.startTime-t.startTime}))}),n}var a={findPrevBar:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null!=t.startTime?t.startTime:e.positionTime,i=e.musicMap.beats||[];i=i.reverse();for(var a=0;a<i.length;++a)if(1==i[a].number&&n>i[a].startTime+r)return i[a];return i[0]},findNextBar:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null!=t.startTime?t.startTime:e.positionTime,i=e.musicMap.beats||[],a=0;a<i.length;++a)if(1==i[a].number&&n<i[a].startTime-r)return i[a];return i[0]},findPrevRepeatedSectionItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null!=t.startTime?t.startTime:e.positionTime,a=i(e,t);a=a.reverse();for(var o=0;o<a.length;++o)if(n>a[o].startTime+r)return a[o];return a[0]},findNextRepeatedSectionItem:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null!=t.startTime?t.startTime:e.positionTime,a=i(e,t),o=0;o<a.length;++o)if(n<a[o].startTime-r)return a[o];return a[0]}};t.default=a},15:function(e,t,n){"use strict";n.r(t);var r=n(26);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,r["default"]);var t,n,u,s=o(c);function c(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(e=s.call(this)).endpointScheme=null!=t.endpointScheme?t.endpointScheme:null,e.endpointHost=null!=t.endpointHost?t.endpointHost:null,e.endpointPath=null!=t.endpointPath?t.endpointPath:null,e.revisionId=null!=t.revisionId?t.revisionId:0,e.offset=null!=t.offset?t.offset:0,e.pollingInterval=null!=t.pollingInterval?t.pollingInterval:50,e}return t=c,(n=[{key:"__invokeTrap__",value:function(e,t){e.trap({target:this,type:e.name,data:t})}}])&&i(t.prototype,n),u&&i(t,u),c}();t.default=s},17:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},174:function(e,t,n){"use strict";n.r(t);var r=n(70),i=n(96);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(n,r["default"]);var t=o(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this,r)).addPlugin(new i.default),e}return n}();t.default=s},185:function(e,t,n){"use strict";n.r(t);var r=n(70),i=n(97);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(n,r["default"]);var t=o(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this,r)).addPlugin(new i.default),e}return n}();t.default=s},19:function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(1);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.traps=[]}var t,n,o;return t=e,o=[{key:"Name",get:function(){return"dispatcher"}},{key:"Type",get:function(){return"dispatcher"}}],(n=[{key:"initialize",value:function(e){r.default.debug("Invoke '".concat(this.dispatcherName,"#initialize'")),this.__player__=e}},{key:"mediaTryMount",value:function(e,t){r.default.debug("Invoke '".concat(this.dispatcherName,"#mediaTryMount'"),t)}},{key:"mediaDisMount",value:function(e,t){r.default.debug("Invoke '".concat(this.dispatcherName,"#mediaDisMount'"),t)}},{key:"mediaDidMount",value:function(e,t){r.default.debug("Invoke '".concat(this.dispatcherName,"#mediaDidMount'"),t)}},{key:"dispose",value:function(){r.default.debug("Invoke '".concat(this.dispatcherName,"#dispose'"))}},{key:"mapTraps",value:function(e){var t=this,n=this.player.dispatchers.map(function(n){return n&&n.traps.map(function(n){if(-1!=t.__convertToStringArray__(e).indexOf(n.name))return n}).filter(function(e){return null!=e})});return Array.prototype.concat.apply([],n)}},{key:"mapTrapsHasAnyData",value:function(e){return this.mapTraps(e).filter(function(e){return e&&null!=e.data})}},{key:"mapTrapsHasNotData",value:function(e){return this.mapTraps(e).filter(function(e){return e&&null==e.data})}},{key:"on",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r.offset=null!=r.offset?r.offset:0,(e=this.__convertToStringArray__(e)).forEach(function(e){e=n.__validateTrapName__(e),n.traps.push({name:e,trap:t,data:null,options:r})})}},{key:"off",value:function(e,t){var n=this;arguments.length>2&&void 0!==arguments[2]&&arguments[2];(e=this.__convertToStringArray__(e)).forEach(function(e){e=n.__validateTrapName__(e),n.traps.forEach(function(r,i){r.name===e&&r.trap===t&&n.traps.splice(i,1)})})}},{key:"invokeSelfTrap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=this.__validateTrapName__(e),this.traps.forEach(function(n){n.name==e&&(t.type=e,n.trap(t))})}},{key:"__convertToStringArray__",value:function(e){return"string"===i.default.typeOf(e)?[e]:e}},{key:"__validateTrapName__",value:function(e){switch(e){case"beatPlay":e="beatEnter";break;case"chordChange":case"chordPlay":e="chordEnter";break;case"melodyPlay":e="melodyEnter";break;case"variationChange":case"variationPlay":e="variationEnter";break;case"chorusEnter":e="chorusSectionEnter";break;case"chorusLeave":e="chorusSectionLeave";break;case"repeatEnter":case"repeatSectionEnter":e="repeatedSectionEnter";break;case"repeatLeave":case"repeatSectionLeave":e="repeatedSectionLeave";break;case"songleSyncNodeChange":e="songleSyncStageNodeChange";break;case"songleSyncNodeEnter":e="songleSyncStageNodeEnter";break;case"songleSyncNodeLeave":e="songleSyncStageNodeLeave"}return e}},{key:"dispatcherName",get:function(){return e.Name}},{key:"dispatcherType",get:function(){return e.Type}},{key:"player",get:function(){return this.__player__}}])&&a(t.prototype,n),o&&a(t,o),e}();t.default=o},2:function(e,t,n){"use strict";n.r(t);var r=n(1);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=[],o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"debug",value:function(t,n){r.default.showDebugLog&&e.__log__("debug",t,n,"color:#000;")}},{key:"warn",value:function(t,n){r.default.showErrorLog&&e.__log__("warn",t,n,"color:#f82;")}},{key:"error",value:function(t,n){r.default.showErrorLog&&e.__log__("error",t,n,"color:#f22;")}},{key:"__log__",value:function(e,t,n,i){switch(e){case"debug":t="[Songle API ".concat(e,"] ")+t;break;case"warn":case"error":if(t="[Songle API ".concat(e,"] ")+t,-1!=a.indexOf(t))return}a.push(t),null!=n&&(n=JSON.stringify(n,function(e,t){if(null==t)return t;switch(!0){case t instanceof HTMLElement:return"[HTMLElement]";case null!=t.dispatcherName:return"[".concat(t.dispatcherName,"]");case null!=t.dispatcherType:return"[".concat(t.dispatcherType,"]")}return t},"\t")),console.log((r.default.isWebBrowser?"%c":"")+t+(n?"\n\n"+n+"\n":""),r.default.isWebBrowser?i:"")}},{key:"histories",get:function(){return a}}],(n=null)&&i(t.prototype,n),o&&i(t,o),e}(),u={histories:o.histories,debug:o.debug,warn:o.warn,error:o.error};t.default=u},20:function(e,t,n){"use strict";n.r(t);var r=n(5),i=(n(2),n(1)),a={};var o={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,o){t.cache=null==t.cache||t.cache,t.endpointScheme=null!=t.endpointScheme?t.endpointScheme:"",t.endpointHost=null!=t.endpointHost?t.endpointHost:"",t.endpointPath=null!=t.endpointPath?t.endpointPath:"",t.fallback=null!=t.fallback&&t.fallback;var u=function(e,t){var n=t.endpointScheme,r=t.endpointHost,a=t.endpointPath,o=t.fallback,u=[];return u.push("syntax=camelcase"),u.push("endpoint_scheme="+"".concat(n)),u.push("endpoint_host="+"".concat(r)),u.push("endpoint_path="+"".concat(a)),u.push("fallback="+"".concat(o?1:0)),u.push("url="+"".concat(encodeURIComponent(e))),"".concat(i.default.defaultAppServerEndpoint,"/api/v2/song.json?").concat(u.join("&"))}(e,t),s=a[u];if(null!=s&&t.cache)return n(s);r.default.getJSON(u).then(function(e){var t=e.meta,r=e.data;if(200!=t.status)return o(e);var i=function(e,t){return Object.keys(e.attributes).forEach(function(t){Object.defineProperty(e,t,{get:function(){return e.attributes[t]}})}),Object.keys(e.relationships).forEach(function(t){Object.defineProperty(e,t,{get:function(){return e.relationships[t].data.attributes}})}),e}(r);return a[u]=i,null==a[i.permalink]&&(a[i.permalink]=i),n(i)},function(e){return o(e)})})}};t.default=o},21:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(2),a=n(1),o={};var u={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,u){t.cache=null==t.cache||t.cache,t.endpointScheme=null!=t.endpointScheme?t.endpointScheme:"",t.endpointHost=null!=t.endpointHost?t.endpointHost:"",t.endpointPath=null!=t.endpointPath?t.endpointPath:"",t.revisionId=null!=t.revisionId?t.revisionId:0;var s=function(e,t){var n=t.endpointScheme,r=t.endpointHost,i=t.endpointPath,o=t.revisionId,u=[];return u.push("syntax=camelcase"),u.push("endpoint_scheme="+"".concat(n)),u.push("endpoint_host="+"".concat(r)),u.push("endpoint_path="+"".concat(i)),u.push("url="+"".concat(encodeURIComponent(e))),u.push("revision_id="+"".concat(o)),"".concat(a.default.defaultAppServerEndpoint,"/api/v2/song/beat.json?").concat(u.join("&"))}(e,t),c=o[s];if(null!=c&&t.cache)return n(c);r.default.getJSON(s).then(function(e){var r=e.meta,a=e.data;if(200!=r.status)return u(e);var c=function(e,t){var n=t.revisionId,r=e.attributes.sequence;return r.forEach(function(e){[{source:"startTimeMs",target:"startTime"},{source:"startTime",target:"start",warning:!0},{source:"numberOfBeatsPerBar",target:"count",warning:!0},{source:"number",target:"position",warning:!0}].forEach(function(t){Object.defineProperty(e,t.target,{get:function(){return t.warning&&i.default.warn("'Beat.".concat(t.target,"' is deprecated API, please use 'Beat.").concat(t.source,"'")),e[t.source]}})}),Object.defineProperty(e,"prev",{get:function(){return r[e.index-1]||null}}),Object.defineProperty(e,"next",{get:function(){return r[e.index+1]||null}})}),{revisionId:n,data:r}}(a,t);return o[s]=c,n(c)},function(e){return u(e)})})}};t.default=u},22:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(2),a=n(1),o={};var u={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,u){t.cache=null==t.cache||t.cache,t.endpointScheme=null!=t.endpointScheme?t.endpointScheme:"",t.endpointHost=null!=t.endpointHost?t.endpointHost:"",t.endpointPath=null!=t.endpointPath?t.endpointPath:"",t.revisionId=null!=t.revisionId?t.revisionId:0;var s=function(e,t){var n=t.endpointScheme,r=t.endpointHost,i=t.endpointPath,o=t.revisionId,u=[];return u.push("syntax=camelcase"),u.push("endpoint_scheme="+"".concat(n)),u.push("endpoint_host="+"".concat(r)),u.push("endpoint_path="+"".concat(i)),u.push("url="+"".concat(encodeURIComponent(e))),u.push("revision_id="+"".concat(o)),"".concat(a.default.defaultAppServerEndpoint,"/api/v2/song/chord.json?").concat(u.join("&"))}(e,t),c=o[s];if(null!=c&&t.cache)return n(c);r.default.getJSON(s).then(function(e){var r=e.meta,a=e.data;if(200!=r.status)return u(e);var c=function(e,t){var n=t.revisionId,r=e.attributes.sequence;return r.forEach(function(e){[{source:"startTimeMs",target:"startTime"},{source:"durationTimeMs",target:"durationTime"},{source:"endTimeMs",target:"endTime"},{source:"startTime",target:"start",warning:!0},{source:"durationTime",target:"duration",warning:!0},{source:"endTime",target:"end",warning:!0}].forEach(function(t){Object.defineProperty(e,t.target,{get:function(){return t.warning&&i.default.warn("'Chord.".concat(t.target,"' is deprecated API, please use 'Chord.").concat(t.source,"'")),e[t.source]}})}),Object.defineProperty(e,"prev",{get:function(){return r[e.index-1]||null}}),Object.defineProperty(e,"next",{get:function(){return r[e.index+1]||null}})}),{revisionId:n,data:r}}(a,t);return o[s]=c,n(c)},function(e){return u(e)})})}};t.default=u},23:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(2),a=n(1),o={};var u={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,u){t.cache=null==t.cache||t.cache,t.endpointScheme=null!=t.endpointScheme?t.endpointScheme:"",t.endpointHost=null!=t.endpointHost?t.endpointHost:"",t.endpointPath=null!=t.endpointPath?t.endpointPath:"",t.revisionId=null!=t.revisionId?t.revisionId:0;var s=function(e,t){var n=t.endpointScheme,r=t.endpointHost,i=t.endpointPath,o=t.revisionId,u=[];return u.push("syntax=camelcase"),u.push("endpoint_scheme="+"".concat(n)),u.push("endpoint_host="+"".concat(r)),u.push("endpoint_path="+"".concat(i)),u.push("url="+"".concat(encodeURIComponent(e))),u.push("revision_id="+"".concat(o)),"".concat(a.default.defaultAppServerEndpoint,"/api/v2/song/melody.json?").concat(u.join("&"))}(e,t),c=o[s];if(null!=c&&t.cache)return n(c);r.default.getJSON(s).then(function(e){var r=e.meta,a=e.data;if(200!=r.status)return u(e);var c=function(e,t){var n=t.revisionId,r=e.attributes.sequence;return r.forEach(function(e){[{source:"startTimeMs",target:"startTime"},{source:"durationTimeMs",target:"durationTime"},{source:"endTimeMs",target:"endTime"},{source:"startTime",target:"start",warning:!0},{source:"durationTime",target:"duration",warning:!0},{source:"endTime",target:"end",warning:!0}].forEach(function(t){Object.defineProperty(e,t.target,{get:function(){return t.warning&&i.default.warn("'Melody.".concat(t.target,"' is deprecated API, please use 'Melody.").concat(t.source,"'")),e[t.source]}})}),Object.defineProperty(e,"prev",{get:function(){return r[e.index-1]||null}}),Object.defineProperty(e,"next",{get:function(){return r[e.index+1]||null}})}),{revisionId:n,data:r}}(a,t);return o[s]=c,n(c)},function(e){return u(e)})})}};t.default=u},24:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(2),a=n(1),o={};var u={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,u){t.cache=null==t.cache||t.cache,t.endpointScheme=null!=t.endpointScheme?t.endpointScheme:"",t.endpointHost=null!=t.endpointHost?t.endpointHost:"",t.endpointPath=null!=t.endpointPath?t.endpointPath:"",t.revisionId=null!=t.revisionId?t.revisionId:0;var s=function(e,t){var n=t.endpointScheme,r=t.endpointHost,i=t.endpointPath,o=t.revisionId,u=[];return u.push("syntax=camelcase"),u.push("endpoint_scheme="+"".concat(n)),u.push("endpoint_host="+"".concat(r)),u.push("endpoint_path="+"".concat(i)),u.push("url="+"".concat(encodeURIComponent(e))),u.push("revision_id="+"".concat(o)),"".concat(a.default.defaultAppServerEndpoint,"/api/v2/song/chorus.json?").concat(u.join("&"))}(e,t),c=o[s];if(null!=c&&t.cache)return n(c);r.default.getJSON(s).then(function(e){var r=e.meta,a=e.data;if(200!=r.status)return u(e);var c=function(e,t){var n=t.revisionId,r=e.attributes.sequence;return r.forEach(function(e){[{source:"durationTimeMs",target:"durationTime"},{source:"items",target:"repeats",warning:!0},{source:"durationTime",target:"duration",warning:!0}].forEach(function(t){Object.defineProperty(e,t.target,{get:function(){return t.warning&&i.default.warn("'ChorusSection.".concat(t.target,"' is deprecated API, please use 'ChorusSection.").concat(t.source,"'")),e[t.source]}})}),e.items.forEach(function(t){[{source:"startTimeMs",target:"startTime"},{source:"durationTimeMs",target:"durationTime"},{source:"endTimeMs",target:"endTime"},{source:"startTime",target:"start",warning:!0},{source:"durationTime",target:"duration",warning:!0},{source:"endTime",target:"end",warning:!0}].forEach(function(e){Object.defineProperty(t,e.target,{get:function(){return e.warning&&i.default.warn("'ChorusSectionItem.".concat(e.target,"' is deprecated API, please use 'ChorusSectionItem.").concat(e.source,"'")),t[e.source]}})}),Object.defineProperty(t,"prev",{get:function(){return e.items[t.index-1]||null}}),Object.defineProperty(t,"next",{get:function(){return e.items[t.index+1]||null}})})}),{revisionId:n,data:r}}(a,t);return o[s]=c,n(c)},function(e){return u(e)})})}};t.default=u},25:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(2),a=n(1),o={};var u={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,u){t.cache=null==t.cache||t.cache,t.endpointScheme=null!=t.endpointScheme?t.endpointScheme:"",t.endpointHost=null!=t.endpointHost?t.endpointHost:"",t.endpointPath=null!=t.endpointPath?t.endpointPath:"",t.revisionId=null!=t.revisionId?t.revisionId:0,t.groupCount=null!=t.groupCount?t.groupCount:2;var s=function(e,t){var n=t.endpointScheme,r=t.endpointHost,i=t.endpointPath,o=t.revisionId,u=t.groupCount,s=[];return s.push("syntax=camelcase"),s.push("endpoint_scheme="+"".concat(n)),s.push("endpoint_host="+"".concat(r)),s.push("endpoint_path="+"".concat(i)),s.push("url="+"".concat(encodeURIComponent(e))),s.push("revision_id="+"".concat(o)),s.push("group_count="+"".concat(u)),"".concat(a.default.defaultAppServerEndpoint,"/api/v2/song/variation.json?").concat(s.join("&"))}(e,t),c=o[s];if(null!=c&&t.cache)return n(c);r.default.getJSON(s).then(function(e){var r=e.meta,a=e.data;if(200!=r.status)return u(e);var c=function(e,t){var n=t.revisionId,r=e.attributes.sequence;return r.forEach(function(e){[{source:"startTimeMs",target:"startTime"},{source:"durationTimeMs",target:"durationTime"},{source:"endTimeMs",target:"endTime"},{source:"startTime",target:"start",warning:!0},{source:"durationTime",target:"duration",warning:!0},{source:"endTime",target:"end",warning:!0}].forEach(function(t){Object.defineProperty(e,t.target,{get:function(){return t.warning&&i.default.warn("'Variation.".concat(t.target,"' is deprecated API, please use 'Variation.").concat(t.source,"'")),e[t.source]}})}),Object.defineProperty(e,"prev",{get:function(){return r[e.index-1]||null}}),Object.defineProperty(e,"next",{get:function(){return r[e.index+1]||null}})}),{revisionId:n,data:r}}(a,t);return o[s]=c,n(c)},function(e){return u(e)})})}};t.default=u},26:function(e,t,n){"use strict";n.r(t);var r=n(19);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,r["default"]);var t,n,u,s=o(c);function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),s.apply(this,arguments)}return t=c,u=[{key:"Name",get:function(){return"plugin"}},{key:"Type",get:function(){return"plugin"}}],(n=[{key:"dispatcherName",get:function(){return c.Name}},{key:"dispatcherType",get:function(){return c.Type}}])&&i(t.prototype,n),u&&i(t,u),c}();t.default=s},28:function(e,t,n){"use strict";n.r(t);var r=n(1);var i={createScriptElement:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.default.global.document.createElement("script");return t.async=t.async||!1,t.defer=t.defer||!1,t.type=t.type||"text/javascript",n.async=t.async,n.defer=t.defer,n.src=e,n.type=t.type,n.addEventListener("abort",t.onAbort,!1),n.addEventListener("error",t.onError,!1),n.addEventListener("load",t.onLoad,!1),n},querySelector:function(e){return"string"===r.default.typeOf(e)?r.default.global.document.querySelector(e):e}};t.default=i},34:function(e,t,n){"use strict";n.r(t);var r=n(53);n.d(t,"ClockAPI",function(){return r.default});var i=n(54);n.d(t,"HistoryAPI",function(){return i.default});var a=n(55);n.d(t,"MessageAPI",function(){return a.default});var o=n(56);n.d(t,"PlaylistAPI",function(){return o.default});var u=n(57);n.d(t,"StageAPI",function(){return u.default});var s={ClockAPI:r.default,HistoryAPI:i.default,MessageAPI:a.default,PlaylistAPI:o.default,StageAPI:u.default};t.default=s},35:function(e,t,n){"use strict";n.r(t);var r=n(2);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.intervalTime=null!=n.intervalTime?n.intervalTime:this.defaultIntervalTime,this.__plugin__=t}var t,n,a;return t=e,(n=[{key:"start",value:function(){var e=this;setTimeout(function(){try{e.runTask()}catch(t){r.default.debug("Worker's runTask is daed")}e.start()},this.intervalTime)}},{key:"runTask",value:function(){}},{key:"update",value:function(){}},{key:"defaultIntervalTime",get:function(){return 0}},{key:"minIntervalTime",get:function(){return 0}},{key:"maxIntervalTime",get:function(){return 0}},{key:"intervalTime",set:function(e){e<this.minIntervalTime&&(r.default.warn("You can't set less than 'minIntervalTime'"),e=this.minIntervalTime),e>this.maxIntervalTime&&(r.default.warn("You can't set more than 'maxIntervalTime'"),e=this.maxIntervalTime),this.__intervalTime__=e},get:function(){return this.__intervalTime__}},{key:"plugin",get:function(){return this.__plugin__}},{key:"player",get:function(){return this.__plugin__.player}}])&&i(t.prototype,n),a&&i(t,a),e}();t.default=a},36:function(e,t,n){"use strict";function r(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);for(var r in t)null!=t[r]&&n.setAttribute(i(r),String(t[r]));return n}function i(e){switch(e){case"strokeWidth":e="stroke-width"}return e}n.r(t);var a={createSVGElement:function(e){return r("svg",e)},createGroupElement:function(e){return r("g",e)},createRectElement:function(e){return r("rect",e)},createCircleElement:function(e){return r("circle",e)},createLineElement:function(e){return r("line",e)},createPolygonElement:function(e){return r("polygon",e)}};t.default=a},38:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(6),o=n(2),u=n(1);function s(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function c(e,t,n){return(c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(n,a["default"].SuperClass);var t=p(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),r=t.call(this,null,null,e),"string"==u.default.typeOf(e)&&o.default.warn("'Songle.Media.Headless' is deprecated API, please use headless option in 'Songle.Player#useMedia'"),r}return f(n,null,[{key:"Name",get:function(){return"songle-api-headless-media"}}]),f(n,[{key:"initialize",value:function(){var e,t=(e=i.a.mark(function e(t){var r=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.player){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c(d(n.prototype),"initialize",this).call(this,t);case 4:this.__intervalId__=setInterval(function(){r.positionTime>=r.durationTime&&r.__invokeMediaStateChangeTrap__(r,a.default.StateFinished)},1e3);case 5:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){s(a,r,i,o,u,"next",e)}function u(e){s(a,r,i,o,u,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"dispose",value:function(){c(d(n.prototype),"dispose",this).call(this),clearInterval(this.__intervalId__)}},{key:"play",value:function(){this.__invokeMediaStateChangeTrap__(this,a.default.StateTimeUpdate),this.__invokeMediaStateChangeTrap__(this,a.default.StatePlaying)}},{key:"pause",value:function(){this.__invokeMediaStateChangeTrap__(this,a.default.StateTimeUpdate),this.__invokeMediaStateChangeTrap__(this,a.default.StatePaused)}},{key:"seekTo",value:function(e){switch(c(d(n.prototype),"seekTo",this).call(this,e),!0){case this.isPlaying:this.__invokeMediaStateChangeTrap__(this,a.default.StateTimeUpdate),this.__invokeMediaStateChangeTrap__(this,a.default.StateSeeking),this.__invokeMediaStateChangeTrap__(this,a.default.StatePlaying);break;case this.isPaused:this.__invokeMediaStateChangeTrap__(this,a.default.StateTimeUpdate),this.__invokeMediaStateChangeTrap__(this,a.default.StateSeeking),this.__invokeMediaStateChangeTrap__(this,a.default.StatePaused)}}},{key:"dispatcherName",get:function(){return n.Name}}]),n}();t.default=h},4:function(e,t,n){e.exports=n(46)},41:function(e,t,n){"use strict";n.r(t);var r=n(13);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,r["default"]);var t,n,u,s=o(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).__enterStates__=[],t.__leaveStates__=[],t}return t=c,(n=[{key:"dispatch",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.__player__.musicMap;i.beats&&i.beats.forEach(function(i){i.prev&&e<i.prev.startTime&&t>=i.prev.startTime&&n.__enterStates__[i.prev.index]&&!n.__leaveStates__[i.prev.index]&&(r.leave&&r.leave({beat:i.prev}),n.__leaveStates__[i.prev.index]=!0),i&&e<i.startTime&&t>=i.startTime&&(n.__enterStates__[i.index]||n.__leaveStates__[i.index]||(r.enter&&r.enter({beat:i}),n.__enterStates__[i.index]=!0))})}},{key:"reset",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.__enterStates__=[],this.__leaveStates__=[]}}])&&i(t.prototype,n),u&&i(t,u),c}();t.default=s},411:function(e,t,n){"use strict";n.r(t);var r=n(70),i=n(174),a=(n(185),n(6)),o=n(26),u=n(38),s=n(60),c=n(58),l=n(59),f=n(47),_=n(48),p=n(49),d=n(50),h=n(51),y=n(96),v=n(97),g=(n(2),n(1)),m=(n(5),n(12)),k={Player:r.default,SyncPlayer:i.default,Media:{SuperClass:a.default,Headless:u.default,HTMLMediaElement:s.default,NNVideo:c.default,YTVideo:l.default},Plugin:{SuperClass:o.default,Beat:f.default,Chord:_.default,Melody:p.default,Chorus:d.default,Variation:h.default,SongleSync:y.default,SongleWidget:v.default},SongleAPI:m.default,System:g.default},b=20;g.default.global.SW=g.default.global.SW||k,g.default.global.Songle=g.default.global.Songle||k,g.default.showDebugLog=!1,g.default.showErrorLog=!0,g.default.showLicense=!0,function e(){setTimeout(function(){g.default.global.SWAPIReady||b<=0||(b--,g.default.global.onSongleWidgetAPIReady&&(g.default.global.onSongleWidgetAPIReady(k),g.default.global.SWAPIReady=!0),g.default.global.onSongleAPIReady&&(g.default.global.onSongleAPIReady(k),g.default.global.SWAPIReady=!0),e())},500)}(),t.default=k},42:function(e,t,n){"use strict";n.r(t);var r=n(13);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,r["default"]);var t,n,u,s=o(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).__enterStates__=[],t.__leaveStates__=[],t}return t=c,(n=[{key:"dispatch",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.__player__.musicMap;i&&i.chords.forEach(function(i){e<i.startTime+i.durationTime&&t>=i.startTime&&(i.prev&&(n.__leaveStates__[i.prev.index]||(n.__leaveStates__[i.prev.index]=!0,r.leave&&r.leave({chord:i.prev}))),i&&(n.__enterStates__[i.index]||(n.__enterStates__[i.index]=!0,r.enter&&r.enter({chord:i}))))})}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.__player__.musicMap;n&&n.chords.forEach(function(n){e.__enterStates__[n.index]&&!e.__leaveStates__[n.index]&&t.leave&&t.leave({chord:n})}),this.__enterStates__=[],this.__leaveStates__=[]}}])&&i(t.prototype,n),u&&i(t,u),c}();t.default=s},43:function(e,t,n){"use strict";n.r(t);var r=n(13);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,r["default"]);var t,n,u,s=o(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).__enterStates__=[],t.__leaveStates__=[],t}return t=c,(n=[{key:"dispatch",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.__player__.musicMap;i&&i.melodies.forEach(function(i){e<i.startTime+i.durationTime&&t>=i.startTime&&(i.prev&&(n.__leaveStates__[i.prev.index]||(n.__leaveStates__[i.prev.index]=!0,r.leave&&r.leave({melody:i.prev}))),i&&(n.__enterStates__[i.index]||(n.__enterStates__[i.index]=!0,r.enter&&r.enter({melody:i}))))})}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.__player__.musicMap;n&&n.melodies.forEach(function(n){e.__enterStates__[n.index]&&!e.__leaveStates__[n.index]&&t.leave&&t.leave({melody:n})}),this.__enterStates__=[],this.__leaveStates__=[]}}])&&i(t.prototype,n),u&&i(t,u),c}();t.default=s},44:function(e,t,n){"use strict";n.r(t);var r=n(13);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,r["default"]);var t,n,u,s=o(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).__enterStates__=[],t.__leaveStates__=[],t}return t=c,(n=[{key:"dispatch",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.__player__.musicMap;i&&i.chorus.forEach(function(i){i.items.forEach(function(a){e<a.startTime+a.durationTime&&t>=a.startTime?n.__invokeEnterTrap__(i,a,r):n.__invokeLeaveTrap__(i,a,r)})})}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.__invokeAllLeaveTrap__(e),this.__enterStates__=[],this.__leaveStates__=[]}},{key:"__getStateIndex__",value:function(e,t){return 16*e.index+t.index}},{key:"__invokeAllEnterTrap__",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.__player__.musicMap;n&&n.chorus.forEach(function(n){n.items.forEach(function(r){e.__invokeEnterTrap__(n,r,t)})})}},{key:"__invokeAllLeaveTrap__",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.__player__.musicMap;n&&n.chorus.forEach(function(n){n.items.forEach(function(r){e.__invokeLeaveTrap__(n,r,t)})})}},{key:"__invokeEnterTrap__",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.__getStateIndex__(e,t);this.__enterStates__[i]||this.__leaveStates__[i]||(e.items.forEach(function(t){n.__invokeLeaveTrap__(e,t,r)}),r.enter&&r.enter({section:e,sectionItem:t}),this.__enterStates__[i]=!0)}},{key:"__invokeLeaveTrap__",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.__getStateIndex__(e,t);this.__enterStates__[r]&&!this.__leaveStates__[r]&&(n.leave&&n.leave({section:e,sectionItem:t}),this.__leaveStates__[r]=!0)}}])&&i(t.prototype,n),u&&i(t,u),c}();t.default=s},45:function(e,t,n){"use strict";n.r(t);var r=n(13);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(c,r["default"]);var t,n,u,s=o(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).__enterStates__=[],t.__leaveStates__=[],t}return t=c,(n=[{key:"dispatch",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.__player__.musicMap;i&&i.variations.forEach(function(i){e<i.startTime+i.durationTime&&t>=i.startTime&&(i.prev&&(n.__leaveStates__[i.prev.index]||(n.__leaveStates__[i.prev.index]=!0,r.leave&&r.leave({variation:i.prev}))),i&&(n.__enterStates__[i.index]||(n.__enterStates__[i.index]=!0,r.enter&&r.enter({variation:i}))))})}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.__player__.musicMap;n&&n.variations.forEach(function(n){e.__enterStates__[n.index]&&!e.__leaveStates__[n.index]&&t.leave&&t.leave({variation:n})}),this.__enterStates__=[],this.__leaveStates__=[]}}])&&i(t.prototype,n),u&&i(t,u),c}();t.default=s},46:function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),o=new E(r||[]);return a._invoke=function(e,t,n){var r=l;return function(i,a){if(r===_)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw a;return C()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=P(o,n);if(u){if(u===d)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=_;var s=c(e,t,n);if("normal"===s.type){if(r=n.done?p:f,s.arg===d)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=p,n.method="throw",n.arg=s.arg)}}}(e,n,o),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}e.wrap=s;var l="suspendedStart",f="suspendedYield",_="executing",p="completed",d={};function h(){}function y(){}function v(){}var g={};g[a]=function(){return this};var m=Object.getPrototypeOf,k=m&&m(m(x([])));k&&k!==n&&r.call(k,a)&&(g=k);var b=v.prototype=h.prototype=Object.create(g);function T(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function S(e,t){var n;this._invoke=function(i,a){function o(){return new t(function(n,o){!function n(i,a,o,u){var s=c(e[i],e,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"===typeof f&&r.call(f,"__await")?t.resolve(f.__await).then(function(e){n("next",e,o,u)},function(e){n("throw",e,o,u)}):t.resolve(f).then(function(e){l.value=e,o(l)},function(e){return n("throw",e,o,u)})}u(s.arg)}(i,a,n,o)})}return n=n?n.then(o,o):o()}}function P(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,P(e,n),"throw"===n.method))return d;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=c(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function x(e){if(e){var n=e[a];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:C}}function C(){return{value:t,done:!0}}return y.prototype=b.constructor=v,v.constructor=y,v[u]=y.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},T(S.prototype),S.prototype[o]=function(){return this},e.AsyncIterator=S,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new S(s(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},T(b),b[u]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=x,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],u=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:x(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),d}},e}(e.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},47:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(15),o=n(41),u=n(14);n(2),n(12);function s(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return(l="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(h,a["default"]);var t,n,r,d=_(h);function h(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),d.apply(this,arguments)}return t=h,n=[{key:"initialize",value:function(e){var t=this;l(p(h.prototype),"initialize",this).call(this,e),e.seekToPrevBar=function(){var t=u.default.findPrevBar(e);t&&e.seekTo(t.start)},e.seekToNextBar=function(){var t=u.default.findNextBar(e);t&&e.seekTo(t.start)},this.on(["play","pause","mediaSeek","seek"],function(e){t.__resetBarLeaveTrap__(),t.__resetBeatLeaveTrap__(),t.__resetBarEnterTrap__(),t.__resetBeatEnterTrap__()});!function e(){t.mapTrapsHasNotData(["barEnter","barLeave","beatEnter","beatLeave"]).forEach(function(e){return e.data=new o.default(t.player)}),setTimeout(function(){t.player.isPlaying&&(t.__invokeBarLeaveTrap__(),t.__invokeBeatLeaveTrap__(),t.__invokeBarEnterTrap__(),t.__invokeBeatEnterTrap__()),e()},t.pollingInterval)}()}},{key:"mediaDidMount",value:function(){var e,t=(e=i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l(p(h.prototype),"mediaDidMount",this).call(this,t),e.next=3,t.media.loadBeat();case 3:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){s(a,r,i,o,u,"next",e)}function u(e){s(a,r,i,o,u,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"__resetBarEnterTrap__",value:function(){this.mapTrapsHasAnyData("barEnter").forEach(function(e){return e.data.reset()})}},{key:"__resetBarLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("barLeave").forEach(function(t){return t.data.reset({leave:function(n){return e.__invokeTrap__(t,n)}})})}},{key:"__resetBeatEnterTrap__",value:function(){this.mapTrapsHasAnyData("beatEnter").forEach(function(e){return e.data.reset()})}},{key:"__resetBeatLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("beatLeave").forEach(function(t){return t.data.reset({leave:function(n){return e.__invokeTrap__(t,n)}})})}},{key:"__invokeBarEnterTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("barEnter").forEach(function(t){return t.data.find({enter:function(n){1==n.beat.position&&e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__invokeBarLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("barLeave").forEach(function(t){return t.data.find({leave:function(n){1==n.beat.position&&e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__invokeBeatEnterTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("beatEnter").forEach(function(t){return t.data.find({enter:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__invokeBeatLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("beatLeave").forEach(function(t){return t.data.find({leave:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"dispatcherName",get:function(){return h.Name}}],r=[{key:"Name",get:function(){return"songle-api-plugin-beat"}},{key:"BarEnterTrapName",get:function(){return"barEnter"}},{key:"BarLeaveTrapName",get:function(){return"barLeave"}},{key:"BeatEnterTrapName",get:function(){return"beatEnter"}},{key:"BeatLeaveTrapName",get:function(){return"beatLeave"}}],n&&c(t.prototype,n),r&&c(t,r),h}();t.default=d},48:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(15),o=n(42);n(14),n(2),n(12);function u(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return(c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var i=_(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(d,a["default"]);var t,n,r,p=f(d);function d(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),p.apply(this,arguments)}return t=d,n=[{key:"initialize",value:function(e){var t=this;c(_(d.prototype),"initialize",this).call(this,e),this.on(["play","pause","mediaSeek","seek"],function(e){t.__resetChordLeaveTrap__(),t.__resetChordEnterTrap__()});!function e(){t.mapTrapsHasNotData(["chordEnter","chordLeave"]).forEach(function(e){return e.data=new o.default(t.player)}),setTimeout(function(){t.player.isPlaying&&(t.__runChordLeaveTrap__(),t.__runChordEnterTrap__()),e()},t.pollingInterval)}()}},{key:"mediaDidMount",value:function(){var e,t=(e=i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(_(d.prototype),"mediaDidMount",this).call(this,t),e.next=3,t.media.loadChord();case 3:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"__resetChordEnterTrap__",value:function(){this.mapTrapsHasAnyData("chordEnter").forEach(function(e){return e.data.reset()})}},{key:"__resetChordLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("chordLeave").forEach(function(t){return t.data.reset({leave:function(n){return e.__invokeTrap__(t,n)}})})}},{key:"__runChordEnterTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("chordEnter").forEach(function(t){return t.data.find({enter:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__runChordLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("chordLeave").forEach(function(t){return t.data.find({leave:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"dispatcherName",get:function(){return d.Name}}],r=[{key:"Name",get:function(){return"songle-api-plugin-chord"}},{key:"ChordEnterTrapName",get:function(){return"chordEnter"}},{key:"ChordLeaveTrapName",get:function(){return"chordLeave"}}],n&&s(t.prototype,n),r&&s(t,r),d}();t.default=p},49:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(15),o=n(43);n(14),n(2),n(12);function u(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return(c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var i=_(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(d,a["default"]);var t,n,r,p=f(d);function d(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),p.apply(this,arguments)}return t=d,n=[{key:"initialize",value:function(e){var t=this;c(_(d.prototype),"initialize",this).call(this,e),this.on(["play","pause","mediaSeek","seek"],function(e){t.__resetMelodyLeaveTrap__(),t.__resetMelodyEnterTrap__()});!function e(){t.mapTrapsHasNotData(["melodyEnter","melodyLeave"]).forEach(function(e){return e.data=new o.default(t.player)}),setTimeout(function(){t.player.isPlaying&&(t.__runMelodyLeaveTrap__(),t.__runMelodyEnterTrap__()),e()},t.pollingInterval)}()}},{key:"mediaDidMount",value:function(){var e,t=(e=i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c(_(d.prototype),"mediaDidMount",this).call(this,t),e.next=3,t.media.loadMelody();case 3:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"__resetMelodyEnterTrap__",value:function(){this.mapTrapsHasAnyData("melodyEnter").forEach(function(e){return e.data.reset()})}},{key:"__resetMelodyLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("melodyLeave").forEach(function(t){return t.data.reset({leave:function(n){return e.__invokeTrap__(t,n)}})})}},{key:"__runMelodyEnterTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("melodyEnter").forEach(function(t){return t.data.find({enter:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__runMelodyLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("melodyLeave").forEach(function(t){return t.data.find({leave:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"dispatcherName",get:function(){return d.Name}}],r=[{key:"Name",get:function(){return"sw-plugin-melody"}},{key:"MelodyEnterTrapName",get:function(){return"melodyEnter"}},{key:"MelodyLeaveTrapName",get:function(){return"melodyLeave"}}],n&&s(t.prototype,n),r&&s(t,r),d}();t.default=p},5:function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(r,i){var a=null!=n.method?n.method:"GET",o=null!=n.responseType?n.responseType:"",u=new XMLHttpRequest;switch(u.addEventListener("abort",function(e){i(u)},!1),u.addEventListener("error",function(e){i(u)},!1),u.addEventListener("load",function(e){r(u)},!1),u.open(a,e,!0),u.responseType=o,a){case"GET":u.send();break;default:u.setRequestHeader("Content-Type","application/json"),u.send(JSON.stringify(t))}})}function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(i,o){r(e,t,{method:n.method,responseType:n.responseType}).then(function(e){var t=a(e);i(t)},function(e){var t=a(e);o(t)})})}function a(e){var t=e.responseText||e.response||"null";return JSON.parse(t)}n.r(t);var o={ajax:r,ajaxJSON:i,getJSON:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.method="GET",i(e,null,t)},postJSON:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.method="POST",i(e,t,n)},putJSON:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.method="PUT",i(e,t,n)},deleteJSON:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.method="DELETE",i(e,t,n)}};t.default=o},50:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(15),o=n(44),u=n(14);n(2),n(12);function s(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return(l="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(h,a["default"]);var t,n,r,d=_(h);function h(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),d.apply(this,arguments)}return t=h,n=[{key:"initialize",value:function(e){var t=this;l(p(h.prototype),"initialize",this).call(this,e),e.seekToPrevChorusSection=function(){var t=u.default.findPrevRepeatedSectionItem(e,{chorusOnly:!0});t&&e.seekTo(t.start)},e.seekToPrevChorusSectionItem=e.seekToPrevChorusSection,e.seekToNextChorusSection=function(){var t=u.default.findNextRepeatedSectionItem(e,{chorusOnly:!0});t&&e.seekTo(t.start)},e.seekToNextChorusSectionItem=e.seekToNextChorusSection,e.seekToPrevRepeatedSection=function(){var t=u.default.findPrevRepeatedSectionItem(e);t&&e.seekTo(t.start)},e.seekToPrevRepeatedSectionItem=e.seekToPrevRepeatedSection,e.seekToNextRepeatedSection=function(){var t=u.default.findNextRepeatedSectionItem(e);t&&e.seekTo(t.start)},e.seekToNextRepeatedSectionItem=e.seekToNextRepeatedSection,this.on(["play","pause","mediaSeek","seek"],function(e){t.__resetChorusSectionLeaveTrap__(),t.__resetChorusSectionEnterTrap__(),t.__resetRepeatedSectionLeaveTrap__(),t.__resetRepeatedSectionEnterTrap__()});!function e(){t.mapTrapsHasNotData(["chorusSectionEnter","chorusSectionLeave","repeatedSectionEnter","repeatedSectionLeave"]).forEach(function(e){return e.data=new o.default(t.player)}),setTimeout(function(){t.player.isPlaying&&(t.__runChorusSectionLeaveTrap__(),t.__runChorusSectionEnterTrap__(),t.__runRepeatedSectionLeaveTrap__(),t.__runRepeatedSectionEnterTrap__()),e()},t.pollingInterval)}()}},{key:"mediaDidMount",value:function(){var e,t=(e=i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l(p(h.prototype),"mediaDidMount",this).call(this,t),e.next=3,t.media.loadChorus();case 3:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){s(a,r,i,o,u,"next",e)}function u(e){s(a,r,i,o,u,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"__resetChorusSectionEnterTrap__",value:function(){this.mapTrapsHasAnyData("chorusSectionEnter").forEach(function(e){return e.data.reset()})}},{key:"__resetChorusSectionLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("chorusSectionLeave").forEach(function(t){return t.data.reset({leave:function(n){n.section.isChorus&&e.__invokeTrap__(t,n)}})})}},{key:"__resetRepeatedSectionEnterTrap__",value:function(){this.mapTrapsHasAnyData("repeatedSectionEnter").forEach(function(e){return e.data.reset()})}},{key:"__resetRepeatedSectionLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("repeatedSectionLeave").forEach(function(t){return t.data.reset({leave:function(n){return e.__invokeTrap__(t,n)}})})}},{key:"__runChorusSectionEnterTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("chorusSectionEnter").forEach(function(t){return t.data.find({enter:function(n){n.section.isChorus&&e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__runChorusSectionLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("chorusSectionLeave").forEach(function(t){return t.data.find({leave:function(n){n.section.isChorus&&e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__runRepeatedSectionEnterTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("repeatedSectionEnter").forEach(function(t){return t.data.find({enter:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__runRepeatedSectionLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("repeatedSectionLeave").forEach(function(t){return t.data.find({leave:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"dispatcherName",get:function(){return h.Name}}],r=[{key:"Name",get:function(){return"sw-plugin-chorus"}},{key:"ChorusSectionEnterTrapName",get:function(){return"chorusSectionEnter"}},{key:"ChorusSectionLeaveTrapName",get:function(){return"chorusSectionLeave"}},{key:"RepeatedSectionEnterTrapName",get:function(){return"repeatedSectionEnter"}},{key:"RepeatedSectionLeaveTrapName",get:function(){return"repeatedSectionLeave"}}],n&&c(t.prototype,n),r&&c(t,r),h}();t.default=d},51:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(15),o=n(45);n(14),n(2),n(12);function u(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function s(e,t,n){return(s="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=2,h=10,y=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,a["default"]);var t=_(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this,r)).__groupCount__=null!=r.groupCount?r.groupCount:2,e.__groupCount__<d&&(e.__groupCount__=d),e.__groupCount__>h&&(e.__groupCount__=h),e}return l(n,null,[{key:"Name",get:function(){return"sw-plugin-variation"}},{key:"MinGroupCount",get:function(){return d}},{key:"MaxGroupCount",get:function(){return h}},{key:"VariationEnterTrapName",get:function(){return"variationEnter"}},{key:"VariationLeaveTrapName",get:function(){return"variationLeave"}}]),l(n,[{key:"initialize",value:function(e){var t=this;s(p(n.prototype),"initialize",this).call(this,e),this.on(["play","pause","mediaSeek","seek"],function(e){t.__resetVariationLeaveTrap__(),t.__resetVariationEnterTrap__()});!function e(){t.mapTrapsHasNotData(["variationEnter","variationLeave"]).forEach(function(e){return e.data=new o.default(t.player)}),setTimeout(function(){t.player.isPlaying&&(t.__runVariationLeaveTrap__(),t.__runVariationEnterTrap__()),e()},t.pollingInterval)}()}},{key:"mediaDidMount",value:function(){var e,t=(e=i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s(p(n.prototype),"mediaDidMount",this).call(this,t),e.next=3,t.media.loadVariation();case 3:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"__resetVariationEnterTrap__",value:function(){this.mapTrapsHasAnyData("variationEnter").forEach(function(e){return e.data.reset()})}},{key:"__resetVariationLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("variationLeave").forEach(function(t){return t.data.reset({leave:function(n){return e.__invokeTrap__(t,n)}})})}},{key:"__runVariationEnterTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("variationEnter").forEach(function(t){return t.data.find({enter:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"__runVariationLeaveTrap__",value:function(){var e=this;this.mapTrapsHasAnyData("variationLeave").forEach(function(t){return t.data.find({leave:function(n){return e.__invokeTrap__(t,n)}},{offset:t.options.offset+e.offset})})}},{key:"dispatcherName",get:function(){return n.Name}}]),n}();t.default=y},53:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(1);var a={getClock:function(e){return new Promise(function(t,n){var a=e.accessToken,o=[];o.push("syntax=camelcase"),r.default.getJSON("".concat(i.default.defaultAppServerEndpoint,"/api/v2/stages/").concat(a,"/clock.json?").concat(o.join("&"))).then(function(e){var r=e.meta,i=e.data;return 200!=r.status?n(e):t(i.attributes.time)},function(e){return n(e)})})}};t.default=a},54:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(1);var a={createHistory:function(e){return new Promise(function(t,n){var a={};a.stage_id=e.stageId,a.node_id=e.nodeId,a.is_master=e.isMaster,a.is_slave=e.isSalve,a.referer=i.default.referer,a.user_agent=i.default.userAgent,r.default.postJSON("".concat(i.default.defaultLogServerEndpoint,"/songle-api.stage-logs"),a).then(function(e){return t(e)},function(e){return n(e)})})}};t.default=a},55:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(1);var a={getMessage:function(e){return new Promise(function(t,n){var a=e.accessToken,o=[];o.push("syntax=camelcase"),r.default.getJSON("".concat(i.default.defaultAppServerEndpoint,"/api/v2/stages/").concat(a,"/message.json?").concat(o.join("&"))).then(function(e){var r=e.meta,i=e.data;return 200!=r.status?n(e):t(i)},function(e){return n(e)})})},updateMessage:function(e,t){return new Promise(function(n,a){var o=e.accessToken,u=e.secretToken,s={syntax:"camelcase"};s.access_token=o,s.secret_token=u,s.data=t,r.default.putJSON("".concat(i.default.defaultAppServerEndpoint,"/api/v2/stages/").concat(o,"/message.json"),s).then(function(e){var t=e.meta,r=e.data;return 200!=t.status?a(e):n(r)},function(e){return a(e)})})}};t.default=a},56:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(1);function a(e){var t=e.map(function(e){var t=e.attributes;return Object.defineProperties(t,{relativeStartTime:{get:function(){return e.attributes.relativeStartTimeMs}},relativeEndTime:{get:function(){return e.attributes.relativeEndTimeMs}},durationTime:{get:function(){return e.attributes.durationTimeMs}},startTime:{get:function(){return e.attributes.relativeStartTimeMs}},endTime:{get:function(){return e.attributes.relativeEndTimeMs}},mediaRelativeStartTime:{get:function(){return e.attributes.mediaRelativeStartTimeMs}},mediaRelativeEndTime:{get:function(){return e.attributes.mediaRelativeEndTimeMs}},mediaDurationTime:{get:function(){return e.attributes.mediaDurationTimeMs}},mediaStartTime:{get:function(){return e.attributes.relativeStartTimeMs+e.attributes.mediaRelativeStartTimeMs}},mediaEndTime:{get:function(){return e.attributes.relativeEndTimeMs+e.attributes.mediaRelativeEndTimeMs}}}),t});return t.forEach(function(e,n){Object.defineProperties(e,{prev:{get:function(){return t[n-1]||null}},next:{get:function(){return t[n+1]||null}}})}),t.sort(function(e,t){return e.index-t.index})}var o={getPlaylist:function(e){return new Promise(function(t,n){var o=e.accessToken,u=[];u.push("syntax=camelcase"),r.default.getJSON("".concat(i.default.defaultAppServerEndpoint,"/api/v2/stages/").concat(o,"/playlist.json?").concat(u.join("&"))).then(function(e){var r=e.meta,i=e.data;return 200!=r.status?n(e):t(a(i))},function(e){return n(e)})})},createPlaylist:function(e,t){return new Promise(function(n,o){var u=e.accessToken,s=e.secretToken,c={syntax:"camelcase"};c.access_token=u,c.secret_token=s,c.items=t,r.default.postJSON("".concat(i.default.defaultAppServerEndpoint,"/api/v2/stages/").concat(u,"/playlist.json"),c).then(function(e){var t=e.meta,r=e.data;return 200!=t.status?o(e):n(a(r))},function(e){return o(e)})})},deletePlaylist:function(e){return new Promise(function(t,n){var o=e.accessToken,u=e.secretToken,s={syntax:"camelcase"};s.access_token=o,s.secret_token=u,r.default.deleteJSON("".concat(i.default.defaultAppServerEndpoint,"/api/v2/stages/").concat(o,"/playlist.json"),s).then(function(e){var r=e.meta,i=e.data;return 200!=r.status?n(e):t(a(i))},function(e){return n(e)})})}};t.default=o},57:function(e,t,n){"use strict";n.r(t);var r=n(5),i=n(1);var a={getStage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,a){var o=e.accessToken,u=null!=t.nodeTimeoutSec?t.nodeTimeoutSec:e.nodeTimeoutSec,s=[];s.push("syntax=camelcase"),null!=u&&s.push("node_timeout_sec="+u),r.default.getJSON("".concat(i.default.defaultAppServerEndpoint,"/api/v2/stages/").concat(o,".json?").concat(s.join("&"))).then(function(e){var t=e.meta,r=e.data;return 200!=t.status?a(e):n(r)},function(e){return a(e)})})},updateStage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,a){var o=e.accessToken,u=e.secretToken,s=null!=t.nodeTimeoutSec?t.nodeTimeoutSec:e.nodeTimeoutSec,c=null!=t.stateId?t.stateId:null,l=null!=t.absoluteStartTime?t.absoluteStartTime:null,f=null!=t.absoluteStartTimeOffset?t.absoluteStartTimeOffset:null,_=null!=t.absolutePauseTime?t.absolutePauseTime:null,p=null!=t.absolutePauseTimeOffset?t.absolutePauseTimeOffset:null,d={syntax:"camelcase"};d.access_token=o,d.secret_token=u,null!=s&&(d.node_timeout_sec=s),null!=c&&(d.state_id=c),null!=l&&(d.absolute_start_time_ms=l),null!=f&&(d.absolute_start_time_offset_ms=f),null!=_&&(d.absolute_pause_time_ms=_),null!=p&&(d.absolute_pause_time_offset_ms=p),r.default.putJSON("".concat(i.default.defaultAppServerEndpoint,"/api/v2/stages/").concat(o,".json"),d).then(function(e){var t=e.meta,r=e.data;return 200!=t.status?a(e):n(r)},function(e){return a(e)})})}};t.default=a},58:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(6);function o(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return(s="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(p,a["default"].SuperClass);var t,n,r,_=l(p);function p(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),_.apply(this,arguments)}return t=p,n=[{key:"initialize",value:function(){var e,t=(e=i.a.mark(function e(t){var n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.player){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,s(f(p.prototype),"initialize",this).call(this,t);case 4:this.originalPlayer.addEventListener("statusChange",function(e){switch(n.__invokeMediaStateChangeTrap__(n,a.default.StateTimeUpdate),e.playerStatus<<4|e.seekStatus<<0){case 32:n.__invokeMediaStateChangeTrap__(n,a.default.StatePlaying);break;case 48:if(n.isSeeking)return;n.__invokeMediaStateChangeTrap__(n,a.default.StatePaused);break;case 50:n.__invokeMediaStateChangeTrap__(n,a.default.StateSeeking);break;case 64:n.__invokeMediaStateChangeTrap__(n,a.default.StateFinished)}});case 5:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function u(e){o(a,r,i,u,s,"next",e)}function s(e){o(a,r,i,u,s,"throw",e)}u(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"dispose",value:function(){s(f(p.prototype),"dispose",this).call(this),this.originalPlayer.dispose()}},{key:"activate",value:function(){var e=this;return new Promise(function(t,n){e.__play__(),setTimeout(function(){return e.__seekTo__(0),e.__pause__(),t()},500)})}},{key:"play",value:function(){this.isPlaying||this.__play__()}},{key:"pause",value:function(){this.isPaused||this.__pause__()}},{key:"stop",value:function(){this.__seekTo__(0),this.__pause__()}},{key:"seekTo",value:function(e){s(f(p.prototype),"seekTo",this).call(this,e),this.__seekTo__(e)}},{key:"__play__",value:function(){this.originalPlayer.play()}},{key:"__pause__",value:function(){this.originalPlayer.pause()}},{key:"__seekTo__",value:function(e){this.originalPlayer.currentTime(e)}},{key:"dispatcherName",get:function(){return p.Name}},{key:"originalPositionTime",get:function(){return this.originalPlayer.currentTime()||0}},{key:"muted",get:function(){return this.originalPlayer.muted()},set:function(e){this.originalPlayer.muted(!!e)}},{key:"volume",get:function(){return 100*this.originalPlayer.volume()},set:function(e){var t=e/100;return t<0?this.originalPlayer.volume(0):t>1?this.originalPlayer.volume(1):void this.originalPlayer.volume(t)}}],r=[{key:"Name",get:function(){return"songle-api-nn-media"}}],n&&u(t.prototype,n),r&&u(t,r),p}();t.default=_},59:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(6);function o(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return(s="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(p,a["default"].SuperClass);var t,n,r,_=l(p);function p(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),_.apply(this,arguments)}return t=p,n=[{key:"initialize",value:function(){var e,t=(e=i.a.mark(function e(t){var n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.player){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,s(f(p.prototype),"initialize",this).call(this,t);case 4:this.originalPlayer.addEventListener("onStateChange",function(e){switch(n.__invokeMediaStateChangeTrap__(n,a.default.StateTimeUpdate),e.data){case 1:n.__invokeMediaStateChangeTrap__(n,a.default.StatePlaying);break;case 2:n.__invokeMediaStateChangeTrap__(n,a.default.StatePaused);break;case 3:n.__invokeMediaStateChangeTrap__(n,a.default.StateSeeking);break;case 0:n.__invokeMediaStateChangeTrap__(n,a.default.StateFinished)}});case 5:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function u(e){o(a,r,i,u,s,"next",e)}function s(e){o(a,r,i,u,s,"throw",e)}u(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"dispose",value:function(){s(f(p.prototype),"dispose",this).call(this),this.originalPlayer.destroy()}},{key:"activate",value:function(){var e=this;return new Promise(function(t,n){e.__play__(),setTimeout(function(){return e.__seekTo__(0),e.__pause__(),t()},500)})}},{key:"play",value:function(){this.isPlaying||this.__play__()}},{key:"pause",value:function(){this.isPaused||this.__pause__()}},{key:"stop",value:function(){this.__seekTo__(0),this.__pause__()}},{key:"seekTo",value:function(e){s(f(p.prototype),"seekTo",this).call(this,e),this.__seekTo__(e)}},{key:"__play__",value:function(){this.originalPlayer.playVideo()}},{key:"__pause__",value:function(){this.originalPlayer.pauseVideo()}},{key:"__seekTo__",value:function(e){this.originalPlayer.seekTo(e/1e3)}},{key:"dispatcherName",get:function(){return p.Name}},{key:"originalPositionTime",get:function(){return 1e3*this.originalPlayer.getCurrentTime()}},{key:"muted",get:function(){return this.originalPlayer.isMuted()},set:function(e){e?this.originalPlayer.mute():this.originalPlayer.unMute()}},{key:"volume",get:function(){return this.originalPlayer.getVolume()},set:function(e){var t=e;return t<0?this.originalPlayer.setVolume(0):t>100?this.originalPlayer.setVolume(100):void this.originalPlayer.setVolume(t)}}],r=[{key:"Name",get:function(){return"songle-api-yt-media"}}],n&&u(t.prototype,n),r&&u(t,r),p}();t.default=_},6:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(19),o=n(47),u=n(48),s=n(49),c=n(50),l=n(51),f=n(2),_=n(1),p=n(12);function d(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function h(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){d(a,r,i,o,u,"next",e)}function u(e){d(a,r,i,o,u,"throw",e)}o(void 0)})}}function y(e,t,n){return(y="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&v(e.prototype,t),n&&v(e,n),e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var i=b(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var T=!1,S=!1,P=!0,w=!1,O={DefaultStateReady:T,DefaultStatePlaying:S,DefaultStatePaused:P,DefaultStateSeeking:w,StateReady:0,StatePlaying:1,StatePaused:2,StateSeeking:3,StateFinished:4,StateTimeUpdate:5,SuperClass:function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(n,a["default"]);var t=k(n);function n(e,r,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this)).__stateIsReady__=T,a.__stateIsPlaying__=S,a.__stateIsPaused__=P,a.__stateIsSeeking__=w,a.__seekTimeHistories__=[],a.__adjustedTime__=0,a.__positionTime__=0,a.__musicMap__={},a.__element__=e,a.__originalPlayer__=r,a.__songleSong__=i,a.__sourceUrl__="string"==_.default.typeOf(i)?i:i.attributes.permalink,a}return g(n,null,[{key:"Name",get:function(){return"media"}},{key:"Type",get:function(){return"media"}}]),g(n,[{key:"initialize",value:function(){var e=h(i.a.mark(function e(t){var r,a,o,u=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.player){e.next=2;break}return e.abrupt("return");case 2:return y(b(n.prototype),"initialize",this).call(this,t),r=0,a=0,o=0,this.on("mediaStateChange",function(e){switch(e.data.mediaStateId){case 1:f.default.debug("Media state change to 'playing'"),a=_.default.currentClockTime,o=0==r?0:a-r,u.__seekTimeHistories__.push(o),u.isMounted&&u.player.invokeTrap("mediaSeek",{target:e.target,data:{positionTime:u.originalPositionTime,seekTime:o}}),r=0,a=0,o=0,u.isMounted&&u.isPaused&&u.player.invokeTrap("mediaPlay",{target:e.target}),u.__setMediaState__(1);break;case 2:f.default.debug("Media state change to 'paused'"),a=_.default.currentClockTime,o=0==r?0:a-r,u.__seekTimeHistories__.push(o),u.isMounted&&u.player.invokeTrap("mediaSeek",{target:e.target,data:{positionTime:u.originalPositionTime,seekTime:o}}),r=0,a=0,o=0,u.isMounted&&!u.isPaused&&u.player.invokeTrap("mediaPause",{target:e.target}),u.__setMediaState__(2);break;case 3:f.default.debug("Media state change to 'seeking'"),r=_.default.currentClockTime,u.__setMediaState__(3);break;case 4:f.default.debug("Media state change to 'finished'"),u.isMounted&&u.player.invokeTrap("mediaFinish",{target:e.target}),u.__setMediaState__(2);break;case 5:u.__seekMediaTo__(u.originalPositionTime);break;default:f.default.error("Unknown media state (ID: ".concat(e.data.mediaStateId,")"))}}),this.on("mediaReady",function(e){f.default.debug("Invoke 'mediaReady'",e.data),u.player.invokeTrap("ready",e)}),this.on("mediaPlay",function(e){f.default.debug("Invoke 'mediaPlay'",e.data),u.player.invokeTrap("play",e)}),this.on("mediaPause",function(e){f.default.debug("Invoke 'mediaPause'",e.data),u.player.invokeTrap("pause",e)}),this.on("mediaSeek",function(e){f.default.debug("Invoke 'mediaSeek'",e.data)}),this.on("mediaFinish",function(e){f.default.debug("Invoke 'mediaFinish'",e.data),u.player.invokeTrap("finish",e),u.__seekMediaTo__(0)}),this.on("seek",function(e){f.default.debug("Invoke 'seek'",e.data),u.seekTo(e.data.positionTime)}),[{source:"originalDurationTime",target:"originalDuration",warning:!0},{source:"originalPositionTime",target:"originalPosition",warning:!0},{source:"durationTime",target:"duration",warning:!0},{source:"positionTime",target:"position",warning:!0}].forEach(function(e){Object.defineProperty(u,e.target,{get:function(){return e.warning&&f.default.warn("'Media.".concat(e.target,"' is deprecated API, please use 'Media.").concat(e.source,"'")),u[e.source]}})}),e.next=17,Promise.all([this.loadBeat(),this.loadChord(),this.loadMelody(),this.loadChorus(),this.loadVariation()]);case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){var e=h(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:null!=this.element&&this.element.remove();case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadBeat",value:function(){var e=h(i.a.mark(function e(){var t,n,r=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},this.player.hasPlugin(o.default.Name)){e.next=3;break}return e.abrupt("return");case 3:if(null==this.musicMap.beats){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,p.BeatAPI.get(this.sourceUrl,t);case 7:n=e.sent,Object.defineProperties(this.__musicMap__,{beatRevisionId:{get:function(){return n.revisionId}},beats:{get:function(){return n.data}}});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadChord",value:function(){var e=h(i.a.mark(function e(){var t,n,r=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},this.player.hasPlugin(u.default.Name)){e.next=3;break}return e.abrupt("return");case 3:if(null==this.musicMap.chords){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,p.ChordAPI.get(this.sourceUrl,t);case 7:n=e.sent,Object.defineProperties(this.__musicMap__,{chordRevisionId:{get:function(){return n.revisionId}},chords:{get:function(){return n.data}}});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadMelody",value:function(){var e=h(i.a.mark(function e(){var t,n,r=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},this.player.hasPlugin(s.default.Name)){e.next=3;break}return e.abrupt("return");case 3:if(null==this.musicMap.melodies){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,p.MelodyAPI.get(this.sourceUrl,t);case 7:n=e.sent,Object.defineProperties(this.__musicMap__,{melodyRevisionId:{get:function(){return n.revisionId}},melodies:{get:function(){return n.data}}});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadChorus",value:function(){var e=h(i.a.mark(function e(){var t,n,r=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},this.player.hasPlugin(c.default.Name)){e.next=3;break}return e.abrupt("return");case 3:if(null==this.musicMap.chorus){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,p.ChorusAPI.get(this.sourceUrl,t);case 7:n=e.sent,Object.defineProperties(this.__musicMap__,{chorusRevisionId:{get:function(){return n.revisionId}},chorus:{get:function(){return n.data}},chorusSetcions:{get:function(){return f.default.warn("'Player.musicMap.chorusSections' is deprecated API, please use 'Player.musicMap.chorus'"),n.data.filter(function(e){return e.isChorus})}},repeatSections:{get:function(){return f.default.warn("'Player.musicMap.repeatSections' is deprecated API, please use 'Player.musicMap.chorus'"),n.data}}});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadVariation",value:function(){var e=h(i.a.mark(function e(){var t,n,r=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:{},this.player.hasPlugin(l.default.Name)){e.next=3;break}return e.abrupt("return");case 3:if(null==this.musicMap.variations){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,p.VariationAPI.get(this.sourceUrl,t);case 7:n=e.sent,Object.defineProperties(this.__musicMap__,{variationRevisionId:{get:function(){return n.revisionId}},variations:{get:function(){return n.data}}});case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"activate",value:function(){var e=this;return new Promise(function(t,n){return e.__setMediaState__(2),t()})}},{key:"play",value:function(){}},{key:"pause",value:function(){}},{key:"stop",value:function(){this.seekTo(0),this.pause()}},{key:"seekTo",value:function(e){this.__seekMediaTo__(e)}},{key:"showElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null!=this.element){var t=null!=e.width?e.width:256,n=null!=e.height?e.height:144;this.element.style.position="",this.element.style.opacity=1,this.element.style.left="",this.element.style.top="",this.element.style.width="number"===_.default.typeOf(t)?t+"px":t,this.element.style.height="number"===_.default.typeOf(n)?n+"px":n}}},{key:"hideElement",value:function(){null!=this.element&&(this.element.style.position="absolute",this.element.style.opacity=0,this.element.style.left="0px",this.element.style.top="0px",this.element.style.width="1px",this.element.style.height="1px")}},{key:"__seekMediaTo__",value:function(e){this.__adjustedTime__=_.default.currentClockTime,this.__positionTime__=e}},{key:"__invokeMediaStateChangeTrap__",value:function(e,t){this.isMounted?this.player.invokeTrap("mediaStateChange",{target:e,data:{mediaStateId:t,positionTime:this.originalPositionTime}}):this.invokeSelfTrap("mediaStateChange",{target:e,data:{mediaStateId:t,positionTime:this.originalPositionTime}})}},{key:"__setMediaState__",value:function(e){switch(e){case 0:this.__stateIsReady__=T,this.__stateIsPlaying__=S,this.__stateIsPaused__=P,this.__stateIsSeeking__=w;break;case 1:this.__stateIsReady__=!0,this.__stateIsPlaying__=!0,this.__stateIsPaused__=!1,this.__stateIsSeeking__=!1;break;case 2:this.__stateIsReady__=!0,this.__stateIsPlaying__=!1,this.__stateIsPaused__=!0,this.__stateIsSeeking__=!1;break;case 3:this.__stateIsReady__=!0,this.__stateIsSeeking__=!0}}},{key:"dispatcherName",get:function(){return n.Name}},{key:"dispatcherType",get:function(){return n.Type}},{key:"element",get:function(){return this.__element__}},{key:"originalPlayer",get:function(){return this.__originalPlayer__}},{key:"sourceUrl",get:function(){return this.__sourceUrl__}},{key:"name",get:function(){return this.__songleSong__.attributes.name}},{key:"artistId",get:function(){return this.__songleSong__.relationships.artist.data.id}},{key:"artistName",get:function(){return this.__songleSong__.relationships.artist.data.attributes.name}},{key:"isMounted",get:function(){return this.player.media==this}},{key:"isReady",get:function(){return this.__stateIsReady__}},{key:"isPlaying",get:function(){return this.__stateIsPlaying__}},{key:"isPaused",get:function(){return this.__stateIsPaused__}},{key:"isSeeking",get:function(){return this.__stateIsSeeking__}},{key:"medianSeekTime",get:function(){var e=this.__seekTimeHistories__.sort(function(e,t){return e-t});return Math.abs(e[Math.floor(e.length/2)]||0)}},{key:"durationTime",get:function(){return this.__songleSong__.attributes.durationTimeMs}},{key:"originalDurationTime",get:function(){return this.durationTime}},{key:"positionTime",get:function(){var e=this.__positionTime__+(this.isPlaying?_.default.currentClockTime-this.__adjustedTime__:0);return e<0?e:e>this.durationTime?this.durationTime:e}},{key:"originalPositionTime",get:function(){return this.positionTime}},{key:"loadedRatio",get:function(){return 0}},{key:"playedRatio",get:function(){return 0==this.durationTime?0:this.positionTime/this.durationTime}},{key:"muted",get:function(){return!0},set:function(e){}},{key:"volume",get:function(){return 0},set:function(e){}},{key:"musicMap",get:function(){return this.__musicMap__}}]),n}()};t.default=O},60:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(6);function o(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return(s="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(p,a["default"].SuperClass);var t,n,r,_=l(p);function p(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),_.apply(this,arguments)}return t=p,n=[{key:"initialize",value:function(){var e,t=(e=i.a.mark(function e(t){var n=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.player){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,s(f(p.prototype),"initialize",this).call(this,t);case 4:this.originalPlayer.addEventListener("play",function(e){n.__invokeMediaStateChangeTrap__(n,a.default.StatePlaying)}),this.originalPlayer.addEventListener("pause",function(e){n.__invokeMediaStateChangeTrap__(n,a.default.StatePaused)}),this.originalPlayer.addEventListener("seeking",function(e){n.__invokeMediaStateChangeTrap__(n,a.default.StateSeeking)}),this.originalPlayer.addEventListener("ended",function(e){n.__invokeMediaStateChangeTrap__(n,a.default.StateFinished)}),this.originalPlayer.addEventListener("timeupdate",function(e){n.__invokeMediaStateChangeTrap__(n,a.default.StateTimeUpdate)});case 9:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function u(e){o(a,r,i,u,s,"next",e)}function s(e){o(a,r,i,u,s,"throw",e)}u(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"dispose",value:function(){s(f(p.prototype),"dispose",this).call(this),this.originalPlayer.remove()}},{key:"activate",value:function(){var e=this;return new Promise(function(t,n){e.__play__(),setTimeout(function(){return e.__seekTo__(0),e.__pause__(),t()},500)})}},{key:"play",value:function(){this.isPlaying||this.__play__()}},{key:"pause",value:function(){this.isPaused||this.__pause__()}},{key:"stop",value:function(){this.__seekTo__(0),this.__pause__()}},{key:"seekTo",value:function(e){s(f(p.prototype),"seekTo",this).call(this,e),this.__seekTo__(e)}},{key:"__play__",value:function(){this.originalPlayer.play()}},{key:"__pause__",value:function(){this.originalPlayer.pause()}},{key:"__seekTo__",value:function(e){this.originalPlayer.currentTime=e/1e3}},{key:"dispatcherName",get:function(){return p.Name}},{key:"originalPositionTime",get:function(){return 1e3*this.originalPlayer.currentTime}},{key:"muted",get:function(){return this.originalPlayer.muted},set:function(e){this.originalPlayer.muted=!!e}},{key:"volume",get:function(){return 100*this.originalPlayer.volume},set:function(e){var t=e/100;return t<0?this.originalPlayer.volume=0:t>1?this.originalPlayer.volume=1:void(this.originalPlayer.volume=t)}}],r=[{key:"Name",get:function(){return"songle-api-html-media-element-media"}}],n&&u(t.prototype,n),r&&u(t,r),p}();t.default=_},65:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(66),a=(n(75),n(67)),o=n(38),u=n(58),s=n(59),c=n(60),l="www.nicovideo.jp",f="soundcloud.com",_="www.youtube.com";var p={create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(p,d){if(n.headless){var h=new o.default(t);h.initialize(e).then(function(){return p(h)},function(){return d()})}else{var y=null!=n.element?n.element:r.default.global.document.body,v=r.default.global.document.createElement("div");v.style.position="absolute",v.style.opacity=0,v.style.left="0px",v.style.top="0px",v.style.width="1px",v.style.height="1px",v.style.zIndex=0,y.appendChild(v);var g=t.relationships.uri.data.attributes.sourceHost;switch(null!=n.altSourceUrl&&(g=new RegExp(_).test(n.altSourceUrl)?_:""),g){case l:return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(r,a){var o=n.controls,u=t.relationships.uri.data.attributes.sourceId;i.default.importClass().then(function(t){t.create(e,u,{autoplay:!1,defaultNoComment:!0,noController:!o,noHeader:!0,noLinkToNiconico:!0,noRelatedVideo:!0,noShare:!0,noTags:!0,width:"100%",height:"100%",onError:function(e){return a(e)},onSuccess:function(e){return r(e)}})},function(){a()})})}(v,t,n).then(function(n){var r=new u.default(v,n,t);r.initialize(e).then(function(){return p(r)},function(){return d()})},function(e){d(e)});case f:return function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2],new Promise(function(e,t){})}(v,t,n).then(function(e){},function(e){d(e)});case _:return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(i,o){var u=!!n.controls,s=t.relationships.uri.data.attributes.sourceId;if(null!=n.altSourceUrl){var c=n.altSourceUrl.match(/watch\?v=(.+)/);s=c[1]}a.default.importClass().then(function(t){var n=r.default.global.document.createElement("div");e.appendChild(n),new t.Player(n,{events:{onError:function(e){return o(e)},onReady:function(e){return i(e.target)}},playerVars:{autohide:"0",autoplay:"0",cc_load_policy:"0",controls:u?"1":"0",disablekb:"1",enablejsapi:"1",fs:u?"1":"0",hl:"0",html5:"1",iv_load_policy:"3",loop:"0",modestbranding:"1",playsinline:"1",rel:"0",showinfo:"0",start:"0"},videoId:s,width:"100%",height:"100%"},function(){o()})})})}(v,t,n).then(function(n){var r=new s.default(v,n,t);r.initialize(e).then(function(){return p(r)},function(){return d()})},function(e){d(e)});default:return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(i,a){var o=n.altSourceUrl,u=n.controls,s=t.relationships.uri.data.attributes.endpointScheme,c=t.relationships.uri.data.attributes.endpointHost,l=t.relationships.uri.data.attributes.endpointPath,f=r.default.global.document.createElement("audio");f.autoplay=!1,f.controls=!!u,f.crossorigin="anonymous",f.loop=!1,f.muted=!1,f.preload="auto",f.src=o||"".concat(s,"://").concat(c).concat(l).concat(t.attributes.code,"/u"),f.addEventListener("abort",function(e){return a(e)}),f.addEventListener("error",function(e){return a(e)}),f.addEventListener("loadstart",function(e){return i(e.target)}),e.appendChild(f)})}(v,t,n).then(function(n){var r=new c.default(v,n,t);r.initialize(e).then(function(){return p(r)},function(){return d()})},function(e){d(e)})}}})}};t.default=p},66:function(e,t,n){"use strict";n.r(t);var r=n(28),i=n(1),a="https://secure-dcdn.cdn.nimg.jp/extplayerv/embed/js/api.js";var o={importClass:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(t,n){if(i.default.NnFactoryClass)return t(i.default.NnFactoryClass);var o=e.element||i.default.global.document.body;i.default.global.onNicoPlayerFactoryReady=function(e){i.default.NnFactoryClass=i.default.NnFactoryClass||i.default.global.NN||e},o.appendChild(r.default.createScriptElement(a,{onAbort:function(e){return n()},onError:function(e){return n()},onLoad:function(e){var n=setInterval(function(){i.default.NnFactoryClass&&i.default.NnFactoryClass.create&&(clearInterval(n),t(i.default.NnFactoryClass))},1)}}))})}};t.default=o},67:function(e,t,n){"use strict";n.r(t);var r=n(28),i=n(1),a="https://www.youtube.com/iframe_api";var o={importClass:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(t,n){if(i.default.YtFactoryClass)return t(i.default.YtFactoryClass);var o=e.element||i.default.global.document.body;i.default.global.onYouTubeIframeAPIReady=function(e){i.default.YtFactoryClass=i.default.YtFactoryClass||i.default.global.YT||e},o.appendChild(r.default.createScriptElement(a,{onAbort:function(e){return n()},onError:function(e){return n()},onLoad:function(e){var n=setInterval(function(){i.default.YtFactoryClass&&i.default.YtFactoryClass.Player&&(clearInterval(n),t(i.default.YtFactoryClass))},1)}}))})}};t.default=o},70:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(19),o=n(6),u=n(2),s=n(65),c=n(1),l=n(28),f=n(38),_=n(12);function p(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){p(a,r,i,o,u,"next",e)}function u(e){p(a,r,i,o,u,"throw",e)}o(void 0)})}}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=k(e);if(t){var i=k(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return m(e)}(this,n)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(n,a["default"]);var t=g(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).__dispatchers__=[],e.__mediaCaches__=[],e.__accessToken__=r.accessToken,e.__secretToken__=r.secretToken,e.__mediaElement__=r.mediaElement;return[{source:"durationTime",target:"duration",warning:!0},{source:"positionTime",target:"position",warning:!0}].forEach(function(t){Object.defineProperty(m(e),t.target,{get:function(){return t.warning&&u.default.warn("'Player.".concat(t.target,"' is deprecated API, please use 'Player.").concat(t.source,"'")),e[t.source]}})}),e}return y(n,null,[{key:"Name",get:function(){return"player"}},{key:"Type",get:function(){return"player"}},{key:"MinVolume",get:function(){return 0}},{key:"MaxVolume",get:function(){return 100}}]),y(n,[{key:"activate",value:function(){return this.media.activate()}},{key:"useMedia",value:function(){var e=d(i.a.mark(function e(t){var n,r,a,o,l,p,d,h=this,y=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=y.length>1&&void 0!==y[1]?y[1]:{},t.options&&u.default.warn("The 1st arg of `SongleAPI.Player.useMedia` exists the `options` attribute, but it's ignored"),n.altSourceUrl=null!=n.altSourceUrl?n.altSourceUrl:null!=n.src?n.src:null,n.element=null!=n.element?n.element:null!=n.rootElement?n.rootElement:null,n.controls=null!=n.controls?n.controls:null!=n.showCtrl?n.showCtrl:null,n.width=null!=n.width?n.width:null!=n.width?n.videoSizeW:null,n.height=null!=n.height?n.height:null!=n.height?n.videoSizeH:null,n.endpointScheme=null!=n.endpointScheme?n.endpointScheme:null,n.endpointHost=null!=n.endpointHost?n.endpointHost:null,n.endpointPath=null!=n.endpointPath?n.endpointPath:null,n.fallback=null!=n.fallback?n.fallback:null,n.headless=null!=n.headless&&n.headless,n.altSourceUrl=null!=n.altSourceUrl?n.altSourceUrl:null,n.element=null!=n.element?n.element:this.mediaElement,n.controls=null!=n.controls&&n.controls,n.width=null!=n.width?n.width:256,n.height=null!=n.height?n.height:144,t instanceof f.default&&(n.headless=!0),u.default.debug("Songle.Player#useMedia options",n),n.width<200&&n.height<200&&u.default.warn("Video size is too small, please check the terms of use of this video provider"),e.t0=!0,e.next=e.t0===(null==t)?23:e.t0===("string"===c.default.typeOf(t))?24:e.t0===("object"===c.default.typeOf(t)&&null!=t.mediaSourceUrl)?26:e.t0===("object"===c.default.typeOf(t)&&null!=t.permalink)?28:e.t0===("object"===c.default.typeOf(t)&&null!=t.sourceUrl)?30:e.t0===("object"===c.default.typeOf(t)&&null!=t.src)?32:34;break;case 23:return e.abrupt("return");case 24:return r=t,e.abrupt("break",36);case 26:return r=t.mediaSourceUrl,e.abrupt("break",36);case 28:return r=t.permalink,e.abrupt("break",36);case 30:return r=t.sourceUrl,e.abrupt("break",36);case 32:return r=t.src,e.abrupt("break",36);case 34:return u.default.error("Requested new media is unsupported with 'Songle.Player#useMedia'"),e.abrupt("return");case 36:return e.next=38,Promise.all(this.dispatchers.map(function(e){return e&&e.mediaTryMount(h,{newMediaSourceUrl:r})}));case 38:return a=n.endpointScheme,o=n.endpointHost,l=n.endpointPath,p=n.headless,e.next=44,_.SongAPI.get(r,{endpointScheme:a,endpointHost:o,endpointPath:l});case 44:if(d=e.sent,null==this.__media__){e.next=57;break}e.t1=this.__media__.dispatcherName,e.next=e.t1===f.default.Name?49:53;break;case 49:if(!p||n.altSourceUrl){e.next=52;break}if(this.__media__.sourceUrl!==d.attributes.permalink){e.next=52;break}return e.abrupt("return");case 52:return e.abrupt("break",57);case 53:if(p||n.altSourceUrl){e.next=56;break}if(this.__media__.sourceUrl!==d.attributes.permalink){e.next=56;break}return e.abrupt("return");case 56:return e.abrupt("break",57);case 57:if(!this.__mediaTransaction__){e.next=60;break}return u.default.warn("Before finish 'Songle.Player#useMedia', it was called again. please check it using 'mediaReady' event"),e.abrupt("return");case 60:return this.__mediaTransaction__=!this.__mediaTransaction__,e.next=63,Promise.all(this.dispatchers.map(function(e){return e&&e.mediaDisMount(h)}));case 63:if(null!=this.media&&this.media.hideElement(),null!=this.media&&null==this.mediaCaches.find(function(e){return e==h.media})&&this.media.dispose(),e.t2=this.__getCachedMedia__(d,n),e.t2){e.next=70;break}return e.next=69,s.default.create(this,d,n);case 69:e.t2=e.sent;case 70:return this.__media__=e.t2,null!=this.media&&this.media.showElement(n),e.next=74,Promise.all(this.dispatchers.map(function(e){return e&&e.mediaDidMount(h)}));case 74:this.invokeTrap("mediaReady",{target:this,data:{media:this.__media__}}),this.__mediaTransaction__=!this.__mediaTransaction__;case 76:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"cacheMedia",value:function(){var e=d(i.a.mark(function e(t){var n,r=this;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=c.default.typeOf(t),e.next="array"===e.t0?3:"object"===e.t0?5:"string"===e.t0?7:9;break;case 3:return t=t.map(function(e){return"string"==c.default.typeOf(e)?{mediaSourceUrl:e}:e}),e.abrupt("break",9);case 5:return t=[t],e.abrupt("break",9);case 7:return t=[{mediaSourceUrl:t}],e.abrupt("break",9);case 9:return e.next=11,Promise.all(t.map(function(){var e=d(i.a.mark(function e(t){var n,a,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(n=null!=t.options?t.options:{}).endpointScheme=null!=n.endpointScheme?n.endpointScheme:null,n.endpointHost=null!=n.endpointHost?n.endpointHost:null,n.endpointPath=null!=n.endpointPath?n.endpointPath:null,n.headless=null!=n.headless&&n.headless,n.altSourceUrl=null!=n.altSourceUrl?n.altSourceUrl:null,n.element=null!=n.element?n.element:r.mediaElement,n.controls=null!=n.controls&&n.controls,n.width=null!=n.width?n.width:256,n.height=null!=n.height?n.height:144,e.next=12,_.SongAPI.get(t.mediaSourceUrl,n);case 12:return a=e.sent,e.next=15,s.default.create(r,a,n);case 15:return(o=e.sent).altSourceUrl=n.altSourceUrl,r.mediaCaches.push(o),e.abrupt("return",o);case 19:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 11:return n=e.sent,e.abrupt("return",n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"addPlugin",value:function(e){this.hasPlugin(e.dispatcherName)?u.default.warn("'".concat(e.dispatcherName,"' is already installed")):(e.initialize(this),this.__dispatchers__.push(e))}},{key:"hasPlugin",value:function(e){return-1!=this.dispatchers.findIndex(function(t){return t&&t.dispatcherName===e})}},{key:"invokeTrap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.dispatchers.forEach(function(n){n&&n.invokeSelfTrap(e,t)})}},{key:"play",value:function(){null!=this.__media__?this.media.play():u.default.warn("Player don't have a media, Please set a media using 'Songle.Player#useMedia'")}},{key:"pause",value:function(){null!=this.__media__?this.media.pause():u.default.warn("Player don't have a media, Please set a media using 'Songle.Player#useMedia'")}},{key:"stop",value:function(){null!=this.__media__?this.media.stop():u.default.warn("Player don't have a media, Please set a media using 'Songle.Player#useMedia'")}},{key:"seekTo",value:function(e){null!=this.__media__?this.invokeTrap("seek",{target:this,data:{positionTime:e}}):u.default.warn("Player don't have a media, Please set a media using 'Songle.Player#useMedia'")}},{key:"__getCachedMedia__",value:function(e,t){return this.mediaCaches.find(function(n){var r;switch(!0){case null==e:return!1;case"string"===c.default.typeOf(e):r=e;break;case"object"===c.default.typeOf(e)&&null!=e.targetMediaSourceUrl:r=e.targetMediaSourceUrl;break;case"object"===c.default.typeOf(e)&&null!=e.permalink:r=e.permalink;break;case"object"===c.default.typeOf(e)&&null!=e.sourceUrl:r=e.sourceUrl;break;case"object"===c.default.typeOf(e)&&null!=e.src:r=e.src;break;default:return!1}var i=n.sourceUrl===r,a=t.headless&&null==n.originalPlayer||!t.headless&&null!=n.originalPlayer,o=t.altSourceUrl&&t.altSourceUrl==n.altSourceUrl||!t.altSourceUrl;return i&&a&&o})}},{key:"dispatcherName",get:function(){return n.Name}},{key:"dispatcherType",get:function(){return n.Type}},{key:"accessToken",get:function(){return this.__accessToken__||""},set:function(e){this.__accessToken__=e}},{key:"secretToken",get:function(){return this.__secretToken__||""},set:function(e){this.__secretToken__=e}},{key:"mediaElement",get:function(){return l.default.querySelector(this.__mediaElement__)},set:function(e){this.__mediaElement__=e}},{key:"dispatchers",get:function(){return this.__dispatchers__.concat([this,this.media])}},{key:"media",get:function(){return this.__media__}},{key:"mediaCaches",get:function(){return this.__mediaCaches__}},{key:"musicMap",get:function(){return null==this.media?null:this.__media__.musicMap}},{key:"isReady",get:function(){return null==this.media?o.default.DefaultStateReady:this.media.isReady}},{key:"isPlaying",get:function(){return null==this.media?o.default.DefaultStatePlaying:this.media.isPlaying}},{key:"isPaused",get:function(){return null==this.media?o.default.DefaultStatePaused:this.media.isPaused}},{key:"isSeeking",get:function(){return null==this.media?o.default.DefaultStateSeeking:this.media.isSeeking}},{key:"positionTime",get:function(){return null==this.media?0:this.media.positionTime}},{key:"durationTime",get:function(){return null==this.media?0:this.media.durationTime}},{key:"muted",get:function(){return this.media.muted},set:function(e){this.media.muted=e}},{key:"volume",get:function(){return this.media.volume},set:function(e){this.media.volume=e<0?0:e>100?100:e}}]),n}();t.default=b},75:function(e,t,n){"use strict";n.r(t);var r=n(28),i=n(1),a="https://w.soundcloud.com/player/api.js";var o={importClass:function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0],new Promise(function(e,t){if(i.default.ScFactoryClass)return e(i.default.ScFactoryClass);(options.element||i.default.global.document.body).appendChild(r.default.createScriptElement(a,{onAbort:function(e){return t()},onError:function(e){return t()},onLoad:function(e){var t=setInterval(function(){i.default.global.SC&&(i.default.ScFactoryClass=i.default.global.SC,i.default.ScFactoryClass&&(clearInterval(t),read(i.default.ScFactoryClass)))},1)}}))})}};t.default=o},8:function(e,t,n){"use strict";n.r(t);var r=n(1),i="songle-api-license";function a(){return document.querySelector(".".concat(i))}var o={createLicense:function(e){if(!r.default.isStandalone){var t=a();if(!t){switch((t=document.createElement("img")).className=i,t.style.cursor="pointer",t.style.borderRadius="4px",t.style.position="fixed",t.style.zIndex="9999",e){case"left-top":t.style.left="4px",t.style.top="4px",t.style.width="24px",t.style.height="24px";break;case"left-bottom":t.style.left="4px",t.style.bottom="4px",t.style.width="24px",t.style.height="24px";break;case"right-top":t.style.right="4px",t.style.top="4px",t.style.width="24px",t.style.height="24px";break;default:case"right-bottom":t.style.right="4px",t.style.bottom="4px",t.style.width="24px",t.style.height="24px"}t.alt="Powered by Songle API",t.src="https://api.songle.jp/license-icons/songle.png",t.width=24,t.height=24,t.addEventListener("click",function(e){return open("https://api.songle.jp")},!1),t.addEventListener("touch",function(e){return open("https://api.songle.jp")},!1),document.body&&document.body.appendChild(t)}}},removeLicense:function(){if(!r.default.isStandalone){var e=a();e&&e.remove()}}};t.default=o},86:function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(1);function a(e){try{return i.default.isStandalone?null:i.default.global.localStorage.getItem(e)}catch(t){return r.default.error(t),null}}function o(e,t){try{return i.default.isStandalone?null:i.default.global.localStorage.setItem(e,t)}catch(n){return r.default.error(n),null}}var u={fetch:function(e,t){var n=a(e)||t;return o(e,n),n},get:a,set:o};t.default=u},87:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(35),o=(n(2),n(1)),u=n(34);function s(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){s(a,r,i,o,u,"next",e)}function u(e){s(a,r,i,o,u,"throw",e)}o(void 0)})}}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(p,a["default"]);var t,n,r,s=_(p);function p(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=s.call.apply(s,[this].concat(n))).__histories__=[0],e}return t=p,(n=[{key:"runTask",value:function(){var e=c(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.update();case 2:(t=2*this.intervalTime+this.__random__(0,1e3))<this.minIntervalTime&&(t=this.minIntervalTime),t>this.maxIntervalTime&&(t=this.maxIntervalTime),this.intervalTime=t;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=c(i.a.mark(function e(){var t,n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<3)){e.next=11;break}return n=o.default.currentClockTime,e.next=5,u.ClockAPI.getClock(this.plugin);case 5:r=e.sent,a=o.default.currentClockTime,this.__histories__.push(r-(a+n)/2);case 8:++t,e.next=1;break;case 11:this.__histories__=this.__histories__.sort(function(e,t){return e-t});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"__random__",value:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}},{key:"defaultIntervalTime",get:function(){return 1e3}},{key:"minIntervalTime",get:function(){return 1e3}},{key:"maxIntervalTime",get:function(){return 6e4}},{key:"networkJitterTime",get:function(){return this.__histories__[Math.floor(this.__histories__.length/2)]}}])&&l(t.prototype,n),r&&l(t,r),p}();t.default=d},88:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(35),o=n(2),u=n(1),s=n(34);function c(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){c(a,r,i,o,u,"next",e)}function u(e){c(a,r,i,o,u,"throw",e)}o(void 0)})}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(d,a["default"]);var t,n,r,c=p(d);function d(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=c.call.apply(c,[this].concat(n))).__activeNodeCount__=0,e.__masterNodeCount__=0,e.__stateId__=0,e.__initialAbsoluteStartTime__=0,e.__absoluteStartTime__=0,e.__absolutePauseTime__=0,e.__playlistDurationTime__=0,e.__playlistPositionTime__=0,e.__playlistItems__=[],e}return t=d,(n=[{key:"runTask",value:function(){var e=l(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,s.StageAPI.getStage(this.plugin);case 3:return e.t1=e.sent,e.next=6,e.t0.update.call(e.t0,e.t1);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=l(i.a.mark(function e(t){var n,r,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.attributes.createdAt,a=t.attributes.updatedAt,this.__updateNodeCount__(t),this.__updateState__(t),this.__updateInitialAbsoluteStartTime__(t),this.__updateAbsoluteStartTime__(t),this.__updateAbsolutePauseTime__(t),e.next=10,this.__updateMessage__(t);case 10:return e.next=12,this.__updatePlaylist__(t);case 12:this.__stageId__=n,this.__createdAt__=r,this.__updatedAt__=a;case 15:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"__updateNodeCount__",value:function(e){var t=e.attributes.activeNodeCount,n=e.attributes.masterNodeCount,r=t>this.__activeNodeCount__,i=t<this.__activeNodeCount__;this.__activeNodeCount__=t,this.__masterNodeCount__=n;var a={stageActiveNodeCount:t,stageMasterNodeCount:n};[{source:"stageActiveNodeCount",target:"activeNodeCount",warning:!0},{source:"stageMasterNodeCount",target:"masterNodeCount",warning:!0}].forEach(function(e){Object.defineProperty(a,e.target,{get:function(){return e.warning&&o.default.warn("'".concat(e.target,"' is deprecated API, please use '").concat(e.source,"' in 'songleSyncStageNode[Change|Enter|Leave]' trap")),a[e.source]}})}),(r||i)&&this.player.invokeTrap("songleSyncStageNodeChange",{target:this.plugin,data:a}),r&&this.player.invokeTrap("songleSyncStageNodeEnter",{target:this.plugin,data:a}),i&&this.player.invokeTrap("songleSyncStageNodeLeave",{target:this.plugin,data:a})}},{key:"__updateState__",value:function(e){var t=e.attributes.stateId;t!=this.__stateId__&&(this.__stateId__=t,this.player.invokeTrap("songleSyncStageStateChange",{target:this.plugin,data:{stageStateId:t}}))}},{key:"__updateInitialAbsoluteStartTime__",value:function(e){var t=e.attributes.initialAbsoluteStartTimeMs;t!=this.__initialAbsoluteStartTime__&&(this.__initialAbsoluteStartTime__=t,this.player.invokeTrap("songleSyncStageInitialAbsoluteStartTime",{target:this.plugin,data:{stageInitialAbsoluteStartTime:t}}))}},{key:"__updateAbsoluteStartTime__",value:function(e){var t=e.attributes.absoluteStartTimeMs;t!=this.__absoluteStartTime__&&(this.__absoluteStartTime__=t,this.player.invokeTrap("songleSyncStageAbsoluteStartTimeUpdate",{target:this.plugin,data:{stageAbsoluteStartTime:t}}))}},{key:"__updateAbsolutePauseTime__",value:function(e){var t=e.attributes.absolutePauseTimeMs;t!=this.__absolutePauseTime__&&(this.__absolutePauseTime__=t,this.player.invokeTrap("songleSyncStageAbsolutePauseTimeUpdate",{target:this.plugin,data:{stageAbsolutePauseTime:t}}))}},{key:"__updateMessage__",value:function(e){var t=this;return new Promise(function(n,r){var i=e.attributes.messageCreatedAt,a=e.attributes.messageUpdatedAt;return null==i||null==a?n():i===t.__messageCreatedAt__&&a===t.__messageUpdatedAt__?n():void s.MessageAPI.getMessage(t.plugin).then(function(e){var r=e.attributes.data;return t.__message__=r,t.__messageCreatedAt__=i,t.__messageUpdatedAt__=a,u.default.stringIsBlank(r)||t.player.invokeTrap("songleSyncMessage",{target:t.plugin,data:{message:r}}),n()},function(e){return o.default.error("StageWorker#error",e),r(e)})})}},{key:"__updatePlaylist__",value:function(e){var t=this;return new Promise(function(n,r){var i=e.attributes.playlistDurationTimeMs,a=e.attributes.playlistPositionTimeMs,u=e.attributes.playlistCreatedAt,c=e.attributes.playlistUpdatedAt;return null==u||null==c?n():u===t.__playlistCreatedAt__&&c===t.__playlistUpdatedAt__?n():void s.PlaylistAPI.getPlaylist(t.plugin).then(function(e){return t.__playlistDurationTime__=i,t.__playlistPositionTime__=a,t.__playlistItems__=e,t.__playlistCreatedAt__=u,t.__playlistUpdatedAt__=c,t.player.invokeTrap("songleSyncPlaylistUpdate",{target:t.plugin,data:{playlistItems:e}}),n()},function(e){return o.default.error("StageWorker#error",e),r(e)})})}},{key:"defaultIntervalTime",get:function(){return 3e3}},{key:"minIntervalTime",get:function(){return 1e3}},{key:"maxIntervalTime",get:function(){return 6e4}}])&&f(t.prototype,n),r&&f(t,r),d}();t.default=h},89:function(e,t,n){"use strict";n.r(t);var r=n(35),i=n(2);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(l,r["default"]);var t,n,s,c=u(l);function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=c.call.apply(c,[this].concat(n))).__beforePlaylistItemIndex__=-1,e.__enterStates__=[],e.__leaveStates__=[],e.__finishState__=!1,e.skipMediaStateChange=!1,e}return t=l,(n=[{key:"resetState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=null!=e.force&&e.force,n=this.plugin.__getCurrentPlaylistItem__();(null==n||t||this.__beforePlaylistItemIndex__!=n.index)&&(this.__invokeAllPlaylistItemLeaveTrap__(),this.__beforePlaylistItemIndex__=-1,this.__enterStates__=[],this.__leaveStates__=[],this.__finishState__=!1,i.default.debug("Playlist trap states was reseted"))}},{key:"runTask",value:function(){this.update()}},{key:"update",value:function(){if(this.__invokePlaylistTraps__(),null!=this.player.media&&this.player.media.sourceUrl===this.plugin.playlist.currentItem.mediaSourceUrl)switch(!0){case this.plugin.__getPlaylistMediaIsPlaying__():if(this.player.isPlaying)return;this.skipMediaStateChange||(this.player.media.play(),i.default.debug("Media state was changed to 'playing' by the StateWorker"));break;case this.plugin.__getPlaylistMediaIsStopped__():if(!this.player.isPlaying)return;this.skipMediaStateChange||(this.player.media.pause(),i.default.debug("Media state was changed to 'stopped' by the StateWorker"))}}},{key:"__invokePlaylistTraps__",value:function(){var e=this;this.plugin.stageIsPlaying&&(this.plugin.playlist.items.forEach(function(t){e.plugin.playlist.positionTime<t.relativeStartTime+t.durationTime&&e.plugin.playlist.positionTime>=t.relativeStartTime?e.__invokePlaylistItemEnterTrap__(t):e.__invokePlaylistItemLeaveTrap__(t)}),this.__invokePlaylistFinishTrap__())}},{key:"__invokeAllPlaylistItemEnterTrap__",value:function(){var e=this;this.plugin.playlist.items.forEach(function(t){e.__invokePlaylistItemEnterTrap__(t)})}},{key:"__invokeAllPlaylistItemLeaveTrap__",value:function(){var e=this;this.plugin.playlist.items.forEach(function(t){e.__invokePlaylistItemLeaveTrap__(t)})}},{key:"__invokePlaylistItemEnterTrap__",value:function(e){this.__enterStates__[e.index]||this.__leaveStates__[e.index]||(this.player.invokeTrap("songleSyncPlaylistItemEnter",{target:this.plugin,data:{playlistItem:e}}),this.__beforePlaylistItemIndex__=this.plugin.playlist.currentItem.index,this.__enterStates__[e.index]=!0)}},{key:"__invokePlaylistItemLeaveTrap__",value:function(e){this.__enterStates__[e.index]&&!this.__leaveStates__[e.index]&&(this.player.invokeTrap("songleSyncPlaylistItemLeave",{target:this.plugin,data:{playlistItem:e}}),this.__beforePlaylistItemIndex__=this.plugin.playlist.currentItem.index,this.__leaveStates__[e.index]=!0)}},{key:"__invokePlaylistFinishTrap__",value:function(){this.__finishState__||this.plugin.playlist.positionTime!=this.plugin.playlist.durationTime||(this.player.invokeTrap("songleSyncPlaylistFinish",{target:this.plugin}),this.__finishState__=!0)}},{key:"defaultIntervalTime",get:function(){return 100}},{key:"minIntervalTime",get:function(){return 100}},{key:"maxIntervalTime",get:function(){return 6e4}}])&&a(t.prototype,n),s&&a(t,s),l}();t.default=c},90:function(e,t,n){"use strict";n.r(t);var r=n(35),i=n(38),a=(n(60),n(58),n(59),n(2)),o=n(1);function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(_,r["default"]);var t,n,l,f=c(_);function _(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=f.call.apply(f,[this].concat(n))).__offsetTime__=0,e.__absoluteOffsetTime__=0,e.__integralOffsetTime__=0,e.__lastNegativeSeeking__=!1,e.__lastPositiveSeeking__=!1,e.__stateWorkerRestartTime__=0,e}return t=_,(n=[{key:"runTask",value:function(){this.update()}},{key:"update",value:function(){if(this.plugin.__getPlaylistMediaIsPlaying__()&&null!=this.player&&null!=this.player.media){var e=100;switch(!0){case o.default.userAgentIsAndroid:e=200}var t=-e/2,n=e/2,r=this.plugin.__getPlaylistMediaPositionTime__();if(this.__offsetTime__=this.player.positionTime-r,Math.abs(this.__offsetTime__)<1e3?this.__integralOffsetTime__+=this.__offsetTime__:this.__integralOffsetTime__=0,!this.__restartStateWorker__()){if(this.__offsetTime__<t)switch(this.__lastPositiveSeeking__=!0,this.player.media.dispatcherName){case i.default.Name:return void this.player.media.seekTo(r);default:return void this.player.media.seekTo(r-this.__integralOffsetTime__)}else if(this.__offsetTime__>n)switch(this.__lastNegativeSeeking__=!0,this.player.media.dispatcherName){case i.default.Name:return void this.player.media.seekTo(r);default:return Math.abs(this.__offsetTime__)<1e3?void this.__suspendStateWorker__():void this.player.media.seekTo(r-this.__integralOffsetTime__)}(this.__lastPositiveSeeking__||this.__lastNegativeSeeking__)&&a.default.debug("MediaWorker is running the time synchronization",{allowableOffsetTimeThreshold:e,negativeOffsetTimeThreshold:t,positiveOffsetTimeThreshold:n,offsetTime:this.__offsetTime__}),this.__lastPositiveSeeking__=!1,this.__lastNegativeSeeking__=!1}}}},{key:"__suspendStateWorker__",value:function(){return!this.plugin.stateWorker.skipMediaStateChange&&(!(o.default.currentClockTime<this.__stateWorkerRestartTime__)&&(this.plugin.stateWorker.skipMediaStateChange=!this.plugin.stateWorker.skipMediaStateChange,this.player.media.pause(),this.__stateWorkerRestartTime__=o.default.currentClockTime+Math.abs(this.__offsetTime__),this.intervalTime=1,!0))}},{key:"__restartStateWorker__",value:function(){return!!this.plugin.stateWorker.skipMediaStateChange&&(!(o.default.currentClockTime<this.__stateWorkerRestartTime__)&&(this.plugin.stateWorker.skipMediaStateChange=!this.plugin.stateWorker.skipMediaStateChange,this.player.media.play(),this.intervalTime=this.defaultIntervalTime,!0))}},{key:"defaultIntervalTime",get:function(){return 1e3}},{key:"minIntervalTime",get:function(){return 0}},{key:"maxIntervalTime",get:function(){return 6e4}}])&&u(t.prototype,n),l&&u(t,l),_}();t.default=f},91:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(35),o=n(34);function u(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(_,a["default"]);var t,n,r,f=l(_);function _(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_),f.apply(this,arguments)}return t=_,(n=[{key:"runTask",value:function(){var e,t=(e=i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.HistoryAPI.createHistory(this.plugin);case 2:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"defaultIntervalTime",get:function(){return 3e4}},{key:"minIntervalTime",get:function(){return 15e3}},{key:"maxIntervalTime",get:function(){return 6e4}}])&&s(t.prototype,n),r&&s(t,r),_}();t.default=_},96:function(e,t,n){"use strict";n.r(t);var r=n(4),i=n.n(r),a=n(26),o=(n(38),n(60),n(58),n(59),n(86)),u=n(2),s=n(1),c=n(104),l=n.n(c),f=n(87),_=n(88),p=n(89),d=n(90),h=n(91),y=n(34);function v(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,i)}function g(e,t,n){return(g="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=P(e);if(t){var i=P(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return S(e)}(this,n)}}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=60,O=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(n,a["default"]);var t=T(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).__nodeTimeoutSec__=w,e.__localAbsoluteClockJitterTime__=0,e.__autoUseMedia__=null==r.autoUseMedia||r.autoUseMedia,e.__autoUseMediaOptions__=null!=r.autoUseMediaOptions?r.autoUseMediaOptions:null,e.__clockWorker__=new f.default(S(e),{intervalTime:r.clockWorkerIntervalTime}),e.__stageWorker__=new _.default(S(e),{intervalTime:r.stageWorkerIntervalTime}),e.__stateWorker__=new p.default(S(e),{intervalTime:r.stateWorkerIntervalTime}),e.__mediaWorker__=new d.default(S(e),{intervalTime:r.mediaWorkerIntervalTime}),e.__historyWorker__=new h.default(S(e),{intervalTime:r.historyWorkerIntervalTime}),e}return k(n,null,[{key:"Name",get:function(){return"songle-api-plugin-songle-sync"}}]),k(n,[{key:"initialize",value:function(e){var t=this;g(P(n.prototype),"initialize",this).call(this,e),Object.defineProperties(e,{localAbsoluteClockTime:{get:function(){return t.localAbsoluteClockTime}},localAbsoluteClockJitterTime:{get:function(){return t.localAbsoluteClockJitterTime},set:function(e){return t.localAbsoluteClockJitterTime=e}},stageStateId:{get:function(){return t.stageStateId}},stageActiveNodeCount:{get:function(){return t.stageActiveNodeCount}},stageMasterNodeCount:{get:function(){return t.stageMasterNodeCount}},stageIsStopped:{get:function(){return t.stageIsStopped}},stageIsPlaying:{get:function(){return t.stageIsPlaying}},stageIsPaused:{get:function(){return t.stageIsPaused}},stageInitialAbsoluteStartTime:{get:function(){return t.stageInitialAbsoluteStartTime}},stageAbsoluteStartTime:{get:function(){return t.stageAbsoluteStartTime}},stageAbsolutePauseTime:{get:function(){return t.stageAbsolutePauseTime}},nodeId:{get:function(){return t.nodeId}},nodeTimeoutSec:{get:function(){return t.nodeTimeoutSec},set:function(e){return t.nodeTimeoutSec=e}},isMaster:{get:function(){return t.isMaster}},isSlave:{get:function(){return t.isSlave}},message:{get:function(){return t.message}},playlist:{get:function(){return t.playlist}}}),e.play=function(){return t.__play__()},e.pause=function(){return t.__pause__()},e.stop=function(){return t.__stop__()},e.seekTo=function(e){return t.__seekTo__(e)},e.seekPlaylistTo=function(e){return t.__seekPlaylistTo__(e)},e.seekPlaylistPositionTo=function(e){return t.__seekPlaylistTo__(e)},e.seekToPrevPlaylistItem=function(){return t.__seekToPrevPlaylistItem__()},e.seekToNextPlaylistItem=function(){return t.__seekToNextPlaylistItem__()},e.sync=function(e){return t.__sync__(e)},e.setPlaylist=function(e){return t.__setPlaylist__(e)},e.setMessage=function(e){return t.__setMessage__(e)},this.on("songleSyncStageNodeChange",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data)}),this.on("songleSyncStageNodeEnter",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data)}),this.on("songleSyncStageNodeLeave",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data)}),this.on("songleSyncStageStateChange",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data),t.stageIsStopped&&(t.stateWorker.resetState({force:!0}),t.__defaultMediaChange__())}),this.on("songleSyncStageAbsoluteStartTimeUpdate",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data),t.stageIsPaused||t.stateWorker.resetState()}),this.on("songleSyncStageAbsolutePauseTimeUpdate",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data),t.stageIsPaused||t.stateWorker.resetState()}),this.on("songleSyncMessage",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data)}),this.on("songleSyncPlaylistUpdate",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data),t.stateWorker.resetState({force:!0}),t.__defaultMediaChange__()}),this.on("songleSyncPlaylistItemEnter",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data),t.__defaultMediaChange__()}),this.on("songleSyncPlaylistItemLeave",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data)}),this.on("songleSyncPlaylistFinish",function(e){u.default.debug("Invoke '".concat(e.type,"'"),e.data),t.__stop__(),t.player.mediaCaches.forEach(function(e){e.stop()})}),Promise.resolve().then(function(){return t.clockWorker.runTask()}).then(function(){return t.stageWorker.runTask()}).then(function(){return t.stateWorker.runTask()}).then(function(){return t.mediaWorker.runTask()}).then(function(){return t.historyWorker.runTask()}).then(function(){t.clockWorker.start(),t.stageWorker.start(),t.stateWorker.start(),t.mediaWorker.start(),t.historyWorker.start()})}},{key:"mediaTryMount",value:function(e,t){g(P(n.prototype),"mediaTryMount",this).call(this,e),this.isSlave||0==this.playlist.items.length&&(u.default.warn("If you want to change a media on the Songle Sync, please use 'Songle.Player#setPlaylist' instead of 'Songle.Player#useMedia'"),this.__setPlaylist__(t.newMediaSourceUrl))}},{key:"__defaultMediaChange__",value:function(){var e=this;if(this.__autoUseMedia__){var t=this.__getCurrentPlaylistItem__();if(!this.player.media||this.player.media.sourceUrl!==t.mediaSourceUrl){var n;switch(!0){case null!=t&&null!=t.options&&null!=t.options.useMedia:n=t.options.useMedia;break;case null!=this.__autoUseMediaOptions__:n=this.__autoUseMediaOptions__;break;default:n={headless:null==this.player.mediaElement}}this.player.useMedia(t,n).then(function(){e.player.mediaCaches.forEach(function(e){e.isMounted||e.stop()})})}}}},{key:"__getPlaylistDurationTime__",value:function(){var e=0;return((e=this.stageWorker.__playlistDurationTime__)<0||isNaN(e))&&(e=0),e}},{key:"__getPlaylistPositionTime__",value:function(){var e=0;switch(this.stageStateId){case 0:e=0;break;case 1:e=this.localAbsoluteClockTime-this.stageAbsoluteStartTime;break;case 2:e=this.stageAbsolutePauseTime-this.stageAbsoluteStartTime}return(e<0||isNaN(e))&&(e=0),e>this.stageWorker.__playlistDurationTime__&&(e=this.stageWorker.__playlistDurationTime__),e}},{key:"__getCurrentPlaylistItem__",value:function(){var e=this;return this.stageWorker.__playlistItems__.find(function(t){return t.relativeStartTime+t.durationTime>=e.__getPlaylistPositionTime__()})}},{key:"__getPlaylistMediaState__",value:function(){var e=this.__getCurrentPlaylistItem__();return null!=e&&this.stageIsPlaying&&this.__getPlaylistPositionTime__()<e.mediaStartTime+e.mediaDurationTime&&this.__getPlaylistPositionTime__()>=e.mediaStartTime?1:0}},{key:"__getPlaylistMediaIsStopped__",value:function(){return 0==this.__getPlaylistMediaState__()}},{key:"__getPlaylistMediaIsPlaying__",value:function(){return 1==this.__getPlaylistMediaState__()}},{key:"__getPlaylistMediaPositionTime__",value:function(){var e=this.__getCurrentPlaylistItem__();return null!=e&&this.__getPlaylistMediaIsPlaying__()?this.__getPlaylistPositionTime__()-e.mediaStartTime:0}},{key:"__setPlaylist__",value:function(e){switch(s.default.typeOf(e)){case"array":e=e.map(function(e){return"string"==s.default.typeOf(e)?{mediaSourceUrl:e}:e});break;case"object":e=[e];break;case"string":e=[{mediaSourceUrl:e}]}return y.PlaylistAPI.createPlaylist(this,e)}},{key:"__setMessage__",value:function(e){if(!this.isSlave)return y.MessageAPI.updateMessage(this,e)}},{key:"__play__",value:function(){this.__sync__({stateId:1})}},{key:"__pause__",value:function(){this.__sync__({stateId:2})}},{key:"__stop__",value:function(){this.__sync__({stateId:0})}},{key:"__seekTo__",value:function(e){var t=this.__getCurrentPlaylistItem__();null!=t&&this.__seekPlaylistTo__(t.mediaStartTime+e)}},{key:"__seekPlaylistTo__",value:function(e){this.stageIsPlaying?this.__sync__({absoluteStartTime:this.localAbsoluteClockTime-e}):this.__sync__({stateId:2,absoluteStartTime:this.localAbsoluteClockTime,absolutePauseTime:this.localAbsoluteClockTime+e})}},{key:"__seekToPrevPlaylistItem__",value:function(){var e=this.__getCurrentPlaylistItem__();e.prev&&this.__seekPlaylistTo__(e.prev.startTime)}},{key:"__seekToNextPlaylistItem__",value:function(){var e=this.__getCurrentPlaylistItem__();e.next&&this.__seekPlaylistTo__(e.next.startTime)}},{key:"__sync__",value:function(){var e,t=(e=i.a.mark(function e(){var t,n=arguments;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:{},!this.isSlave){e.next=3;break}return e.abrupt("return");case 3:return e.t0=this.stageWorker,e.next=6,y.StageAPI.updateStage(this,t);case 6:return e.t1=e.sent,e.next=9,e.t0.update.call(e.t0,e.t1);case 9:this.stateWorker.update(),this.mediaWorker.update();case 11:case"end":return e.stop()}},e,this)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){v(a,r,i,o,u,"next",e)}function u(e){v(a,r,i,o,u,"throw",e)}o(void 0)})});return function(){return t.apply(this,arguments)}}()},{key:"dispatcherName",get:function(){return n.Name}},{key:"clockWorker",get:function(){return this.__clockWorker__}},{key:"stageWorker",get:function(){return this.__stageWorker__}},{key:"stateWorker",get:function(){return this.__stateWorker__}},{key:"mediaWorker",get:function(){return this.__mediaWorker__}},{key:"historyWorker",get:function(){return this.__historyWorker__}},{key:"localAbsoluteClockTime",get:function(){return s.default.currentClockTime+this.clockWorker.networkJitterTime+this.localAbsoluteClockJitterTime}},{key:"localAbsoluteClockJitterTime",get:function(){return this.__localAbsoluteClockJitterTime__},set:function(e){var t=-this.__getPlaylistDurationTime__(),n=this.__getPlaylistDurationTime__();e<t&&(u.default.warn("You can't set 'SongleSync.localAbsoluteClockJitterTime' less than ".concat(t," seconds")),e=t),e>n&&(u.default.warn("You can't set 'SongleSync.localAbsoluteClockJitterTime' more than ".concat(n," seconds")),e=n),this.__localAbsoluteClockJitterTime__=e}},{key:"stageId",get:function(){return this.stageWorker.__stageId__}},{key:"stageActiveNodeCount",get:function(){return this.stageWorker.__activeNodeCount__}},{key:"stageMasterNodeCount",get:function(){return this.stageWorker.__masterNodeCount__}},{key:"stageStateId",get:function(){return this.stageWorker.__stateId__}},{key:"stageIsStopped",get:function(){return 0==this.stageWorker.__stateId__}},{key:"stageIsPlaying",get:function(){return 1==this.stageWorker.__stateId__}},{key:"stageIsPaused",get:function(){return 2==this.stageWorker.__stateId__}},{key:"stageInitialAbsoluteStartTime",get:function(){return this.stageWorker.__initialAbsoluteStartTime__}},{key:"stageAbsoluteStartTime",get:function(){return this.stageWorker.__absoluteStartTime__}},{key:"stageAbsolutePauseTime",get:function(){return this.stageWorker.__absolutePauseTime__}},{key:"nodeId",get:function(){return o.default.fetch("".concat(n.Name,".nodeId"),l()())}},{key:"nodeTimeoutSec",get:function(){return this.__nodeTimeoutSec__},set:function(e){30>e&&(u.default.warn("You can't set 'SongleSync.nodeTimeoutSec' less than ".concat(30," seconds")),e=30),3600<e&&(u.default.warn("You can't set 'SongleSync.nodeTimeoutSec' more than ".concat(3600," seconds")),e=3600),this.__nodeTimeoutSec__=e}},{key:"accessToken",get:function(){return this.player.accessToken}},{key:"secretToken",get:function(){return this.player.secretToken}},{key:"isMaster",get:function(){return!s.default.stringIsBlank(this.secretToken)}},{key:"isSlave",get:function(){return s.default.stringIsBlank(this.secretToken)}},{key:"message",get:function(){return this.stageWorker.__message__}},{key:"playlist",get:function(){var e=this.__getPlaylistDurationTime__(),t=this.__getPlaylistPositionTime__(),n=this.__getCurrentPlaylistItem__(),r=this.stageWorker.__playlistItems__;return{absoluteStartTime:this.stageAbsoluteStartTime,durationTime:e,positionTime:t,currentItem:n,items:r}}}]),n}();t.default=O},97:function(e,t,n){"use strict";n.r(t);var r=n(26),i=n(28),a=n(2),o=n(36),u=n(1);function s(e,t,n){return(s="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=256,h=30,y="#e17",v="#222",g=256,m=40,k="#999",b="#eee",T="#f84",S="#48f",P="#e17",w="songle-api-plugin-songle-widget",O=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(n,r["default"]);var t=_(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=t.call(this)).__element__=e.element,r.__responsive__=null!=e.responsive&&e.responsive,r.__showController__=null==e.showController||e.showController,r.__showOriginalSiteLink__=null==e.showOriginalSiteLink||e.showOriginalSiteLink,r.__showMusicMap__=null==e.showMusicMap||e.showMusicMap,r.__showSongleJpSiteLink__=null==e.showSongleJpSiteLink||e.showSongleJpSiteLink,r.__controllerWidth__=null!=e.controllerWidth?e.controllerWidth:d,r.__controllerHeight__=null!=e.controllerHeight?e.controllerHeight:h,r.__controllerMouseEnterColor__=null!=e.controllerMouseEnterColor?e.controllerMouseEnterColor:y,r.__controllerMouseLeaveColor__=null!=e.controllerMouseLeaveColor?e.controllerMouseLeaveColor:v,r.__language__=null!=e.language?e.language:u.default.language,r.__musicMapWidth__=null!=e.musicMapWidth?e.musicMapWidth:g,r.__musicMapHeight__=null!=e.musicMapHeight?e.musicMapHeight:m,r.__musicMapOuterBackgroundColor__=null!=e.musicMapOuterBackgroundColor?e.musicMapOuterBackgroundColor:k,r.__musicMapInnerBackgroundColor__=null!=e.musicMapInnerBackgroundColor?e.musicMapInnerBackgroundColor:b,r.__musicMapChorusSectionColor__=null!=e.musicMapChorusSectionColor?e.musicMapChorusSectionColor:T,r.__musicMapRepeatedSectionColor__=null!=e.musicMapRepeatedSectionColor?e.musicMapRepeatedSectionColor:S,r.__musicMapCursorColor__=null!=e.musicMapCursorColor?e.musicMapCursorColor:P,r.__className__="".concat(w,"-").concat(Math.random().toString(36).slice(-4)),r.__readyTrap__=function(e){return r.render()},r.__playTrap__=function(e){},r.__pauseTrap__=function(e){},r.__seekTrap__=function(e){},r.__resizeTrap__=function(e){r.__responsive__&&r.render()},r.__scrollTrap__=function(e){r.__responsive__&&r.render()},r.__responsive__&&null!=r.element&&(e.width=r.element.offsetWidth,e.height=r.element.offsetHeight),r.__updateSize__(e),r}return l(n,null,[{key:"Name",get:function(){return w}}]),l(n,[{key:"initialize",value:function(e){s(p(n.prototype),"initialize",this).call(this,e),this.player.on("ready",this.__readyTrap__),this.player.on("play",this.__playTrap__),this.player.on("pause",this.__pauseTrap__),this.player.on("seek",this.__seekTrap__),window.addEventListener("resize",this.__resizeTrap__,!1),window.addEventListener("scroll",this.__scrollTrap__,!1)}},{key:"dispose",value:function(){s(p(n.prototype),"dispose",this).call(this),clearInterval(this.__musicMapAnimationIntervalId__),window.removeEventListener("resize",this.__resizeTrap__,!1),window.removeEventListener("scroll",this.__scrollTrap__,!1),this.player.off("ready",this.__readyTrap__),this.player.off("play",this.__playTrap__),this.player.off("pause",this.__pauseTrap__),this.player.off("seek",this.__seekTrap__),this.__removeRenderedElement__()}},{key:"render",value:function(){null!=this.element&&this.__responsive__&&this.__updateSize__({width:this.element.offsetWidth,height:this.element.offsetHeight});var e=document.createElement("div");clearInterval(this.__musicMapAnimationIntervalId__),e.className=this.__className__,e.style.lineHeight="normal",e.style.fontSize="10.5px",this.__showController__&&e.appendChild(this.__createControllerElement__({width:this.__controllerWidth__,height:this.__controllerHeight__,mouseEnterColor:this.__controllerMouseEnterColor__,mouseLeaveColor:this.__controllerMouseLeaveColor__})),this.__showOriginalSiteLink__&&e.appendChild(this.__createOriginalSiteLinkElement__({width:this.__musicMapWidth__,height:15})),this.__showMusicMap__&&e.appendChild(this.__createMusicMapElement__({width:this.__musicMapWidth__,height:this.__musicMapHeight__})),this.__showSongleJpSiteLink__&&e.appendChild(this.__createSongleJpSiteLinkElement__({width:this.__musicMapWidth__,height:15})),this.__removeRenderedElement__(),this.element&&this.element.appendChild(e)}},{key:"__removeRenderedElement__",value:function(){document.querySelectorAll("[class=".concat(this.__className__,"]")).forEach(function(e){e.remove()})}},{key:"__createControllerElement__",value:function(e){var t=document.createElement("div");t.style.display="block",t.style.overflow="hidden",t.style.width=e.width+"px",t.style.height=e.height+"px";var n=document.createElement("div");n.style.display="block",n.style.overflow="hidden",n.style.float="left",n.style.width=e.height+"px",n.style.height=e.height+"px";var r=this.__createPlayButtonElement__({size:e.height,mouseEnterColor:e.mouseEnterColor,mouseLeaveColor:e.mouseLeaveColor}),i=this.__createStopButtonElement__({size:e.height,mouseEnterColor:e.mouseEnterColor,mouseLeaveColor:e.mouseLeaveColor});n.appendChild(r),n.appendChild(i);var a=document.createElement("div");a.style.display="block",a.style.overflow="hidden",a.style.float="left",a.style.width=e.width-e.height+"px",a.style.height=e.height+"px";var o=document.createElement("a");o.href="".concat(u.default.defaultAppServerEndpoint,"/redirect_to/songlejp_song_site?url=").concat(encodeURIComponent(this.player.media.sourceUrl)),o.target="_blank",o.style.display="block",o.style.overflow="hidden",o.style.paddingLeft="8px",o.style.textOverflow="ellipsis",o.style.width=e.width-e.height+"px",o.style.height=e.height/2+"px",o.textContent=this.player.media.name;var s=document.createElement("a");return s.href="".concat(u.default.defaultAppServerEndpoint,"/redirect_to/songlejp_song_site?url=").concat(encodeURIComponent(this.player.media.sourceUrl)),s.target="_blank",s.style.display="block",s.style.overflow="hidden",s.style.paddingLeft="8px",s.style.textOverflow="ellipsis",s.style.width=e.width-e.height+"px",s.style.height=e.height/2+"px",s.textContent=this.player.media.artistName,a.appendChild(o),a.appendChild(s),t.appendChild(n),t.appendChild(a),t}},{key:"__createOriginalSiteLinkElement__",value:function(e){var t=document.createElement("div");t.style.display="block",t.style.overflow="hidden",t.style.width=e.width+"px",t.style.height=e.height+"px";var n=document.createElement("a");switch(n.href="".concat(u.default.defaultAppServerEndpoint,"/redirect_to/original_song_site?url=").concat(encodeURIComponent(this.player.media.sourceUrl)),n.target="_blank",n.style.display="block",n.style.overflow="hidden",n.style.float="left",n.style.margin="".concat(0,"px ").concat(2,"px"),n.style.textOverflow="ellipsis",n.style.textAlign="left",n.style.width=e.width/2-4+"px",n.style.height=e.height-0+"px",this.__language__){case"ja":case"en":default:n.textContent=""}t.appendChild(n);var r=document.createElement("a");switch(r.href="".concat(u.default.defaultAppServerEndpoint,"/redirect_to/original_song_site?url=").concat(encodeURIComponent(this.player.media.sourceUrl)),r.target="_blank",r.style.display="block",r.style.overflow="hidden",r.style.float="left",r.style.margin="".concat(0,"px ").concat(2,"px"),r.style.textOverflow="ellipsis",r.style.textAlign="right",r.style.width=e.width/2-4+"px",r.style.height=e.height-0+"px",this.__language__){case"ja":r.textContent="\u3053\u306e\u914d\u4fe1\u30b5\u30a4\u30c8\u3078";break;case"en":default:r.textContent="Original site"}return t.appendChild(r),t}},{key:"__createMusicMapElement__",value:function(e){var t=this,n=document.createElement("div");if(null==this.player.musicMap||null==this.player.musicMap.chorus)return a.default.warn("'Songle.Player' do NOT have a chorus information. Please install the chorus plugin using 'Songle.Plugin.Chorus'"),n;n.style.width=e.width+"px",n.style.height=e.height+"px";var r=o.default.createSVGElement({width:e.width,height:e.height}),i=e.width-4,s=(e.height-4-6+1)/6,c=0;r.appendChild(o.default.createRectElement({x:0,y:0,width:e.width,height:e.height,fill:"none",stroke:this.__musicMapOuterBackgroundColor__})),r.addEventListener("click",function(e){t.player.seekTo(c||e.offsetX/i*t.player.durationTime),u.default.stringIsBlank(t.player.accessToken)&&u.default.stringIsBlank(t.player.secretToken)&&t.player.play()});for(var l=function(e){var n=(s+1)*e+1+1;r.appendChild(o.default.createRectElement({x:2,y:n,width:i,height:s,fill:t.__musicMapInnerBackgroundColor__,stroke:"none"}));var a=t.player.musicMap.chorus[e];if(!a)return"continue";a.items.forEach(function(e){var u=e.startTime/t.player.durationTime*i+2,l=n,f=e.durationTime/t.player.durationTime*i,_=s,p=o.default.createRectElement({x:u,y:l,width:f,height:_,fill:a.isChorus?t.__musicMapChorusSectionColor__:t.__musicMapRepeatedSectionColor__,stroke:"none"});p.style.cursor="pointer",p.addEventListener("mouseenter",function(){c=e.startTime,p.style.opacity=.75}),p.addEventListener("mouseleave",function(){c=0,p.style.opacity=1}),r.appendChild(p)})},f=0;f<6;++f)l(f);var _=o.default.createRectElement({x:0,y:0,width:1,height:e.height,fill:"none",stroke:this.__musicMapCursorColor__});return this.__musicMapAnimationIntervalId__=setInterval(function(){_.setAttribute("x",e.width*(t.player.positionTime/t.player.durationTime))},1e3),r.appendChild(_),n.appendChild(r),n}},{key:"__createPlayButtonElement__",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null!=t.size?t.size:30,r=null!=t.mouseEnterColor?t.mouseEnterColor:y,i=null!=t.mouseLeaveColor?t.mouseLeaveColor:v,a=null!=t.strokeWidth?t.strokeWidth:2,u=document.createElement("div");u.style.cursor="pointer",u.style.width=n+"px",u.style.height=n+"px",this.player.isPlaying?u.style.display="none":u.style.display="block";var s=o.default.createSVGElement({width:n,height:n}),c=o.default.createGroupElement({fill:i,stroke:i,strokeWidth:a}),l=1*(n/2-a),f=l+a,_=l+a,p=o.default.createCircleElement({cx:f,cy:_,r:l,fill:"none"}),d=.5*(n/2-a),h=1*d/1.41,g=f+Math.cos(3.14/180*135)*d+(d-h),m=_-Math.sin(3.14/180*135)*d,k=f+Math.cos(0)*h,b=_-Math.sin(0)*h,T=f+Math.cos(3.14/180*225)*d+(d-h),S=_-Math.sin(3.14/180*225)*d,P=o.default.createPolygonElement({points:[g,m,k,b,T,S]});return s.appendChild(c),c.appendChild(p),c.appendChild(P),u.appendChild(s),u.addEventListener("click",function(t){e.player.play()}),u.addEventListener("mouseenter",function(e){c.setAttribute("fill",r),c.setAttribute("stroke",r)}),u.addEventListener("mouseleave",function(e){c.setAttribute("fill",i),c.setAttribute("stroke",i)}),this.player.on("play",function(e){u.style.display="none"}),this.player.on("pause",function(e){u.style.display="block"}),u}},{key:"__createStopButtonElement__",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null!=t.size?t.size:30,r=null!=t.mouseEnterColor?t.mouseEnterColor:y,i=null!=t.mouseLeaveColor?t.mouseLeaveColor:v,a=null!=t.strokeWidth?t.strokeWidth:2,u=document.createElement("div");u.style.cursor="pointer",u.style.width=n+"px",u.style.height=n+"px",this.player.isPlaying?u.style.display="block":u.style.display="none";var s=o.default.createSVGElement({width:n,height:n}),c=o.default.createGroupElement({fill:i,stroke:i,strokeWidth:a}),l=1*(n/2-a),f=l+a,_=l+a,p=o.default.createCircleElement({cx:f,cy:_,r:l,fill:"none"}),d=.5*(n/2-a),h=f+Math.cos(3.14/180*135)*d,g=_-Math.sin(3.14/180*135)*d,m=h+.5*Math.abs(h-f),k=g,b=f+Math.cos(3.14/180*225)*d,T=_-Math.sin(3.14/180*225)*d,S=b+.5*Math.abs(h-f),P=T,w=o.default.createPolygonElement({points:[h,g,m,k,S,P,b,T]}),O=f+Math.cos(3.14/180*45)*d,E=_-Math.sin(3.14/180*45)*d,x=O-.5*Math.abs(O-f),C=E,I=f+Math.cos(3.14/180*315)*d,M=_-Math.sin(3.14/180*315)*d,j=I-.5*Math.abs(I-f),R=M,A=o.default.createPolygonElement({points:[x,C,O,E,I,M,j,R]});return s.appendChild(c),c.appendChild(p),c.appendChild(w),c.appendChild(A),u.appendChild(s),u.addEventListener("click",function(t){e.player.pause()}),u.addEventListener("mouseenter",function(e){c.setAttribute("stroke",r),c.setAttribute("fill",r)}),u.addEventListener("mouseleave",function(e){c.setAttribute("stroke",i),c.setAttribute("fill",i)}),this.player.on("play",function(e){u.style.display="block"}),this.player.on("pause",function(e){u.style.display="none"}),u}},{key:"__createSongleJpSiteLinkElement__",value:function(e){var t=document.createElement("div");t.style.display="block",t.style.overflow="hidden",t.style.width=e.width+"px",t.style.height=e.height+"px";var n=document.createElement("a");switch(n.href="".concat(u.default.defaultAppServerEndpoint,"/redirect_to/songlejp_song_site?url=").concat(encodeURIComponent(this.player.media.sourceUrl)),n.target="_blank",n.style.display="block",n.style.overflow="hidden",n.style.float="left",n.style.margin="".concat(0,"px ").concat(2,"px"),n.style.textOverflow="ellipsis",n.style.textAlign="left",n.style.width=e.width/2-4+"px",n.style.height=e.height-0+"px",this.__language__){case"ja":n.textContent="Songle\u3067\u30b5\u30d3\u8a02\u6b63";break;case"en":default:n.textContent="Annotate this song"}t.appendChild(n);var r=document.createElement("a");switch(r.href="".concat(u.default.defaultAppServerEndpoint),r.target="_blank",r.style.display="block",r.style.overflow="hidden",r.style.float="left",r.style.margin="".concat(0,"px ").concat(2,"px"),r.style.textOverflow="ellipsis",r.style.textAlign="right",r.style.width=e.width/2-4+"px",r.style.height=e.height-0+"px",this.__language__){case"ja":case"en":default:r.textContent="Powered by Songle API"}return t.appendChild(r),t}},{key:"__updateSize__",value:function(e){var t=!1;if(null!=e.width){if(e.width<20)return a.default.warn("Songle Widget is too small. Please check 'Songle.Plugin.SongleWidget' options"),!1;this.__controllerWidth__!=e.width&&(this.__controllerWidth__=e.width,t=!0),this.__musicMapWidth__!=e.width&&(this.__musicMapWidth__=e.width,t=!0)}if(null!=e.height){if(this.__showController__&&(e.height-=this.__controllerHeight__),this.__showOriginalSiteLink__&&(e.height-=15),this.__showSongleJpSiteLink__&&(e.height-=15),e.height<20)return a.default.warn("Songle Widget is too small. Please check 'Songle.Plugin.SongleWidget' options"),!1;this.__musicMapHeight__!=e.height&&(this.__musicMapHeight__=e.height,t=!0)}return t}},{key:"dispatcherName",get:function(){return w}},{key:"element",get:function(){return i.default.querySelector(this.__element__)}}]),n}();t.default=O}})});
//# sourceMappingURL=api-270babf21f132e4ccbeb.js.map